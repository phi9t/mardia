{"question": "Let $\\alpha > 1$ be an irrational number and $L$ be a integer such that $L > \\frac{\\alpha^2}{\\alpha - 1}$. A sequence $x_1, x_2, \\cdots$ satisfies that $x_1 > L$ and for all positive integers $n$,\\[ x_{n+1} = \\begin{cases} \\left \\lfloor \\alpha x_n \\right \\rfloor & \\textup{if} \\; x_n  \\leqslant L \\\\left \\lfloor \\frac{x_n}{\\alpha} \\right \\rfloor & \\textup{if}  \\; x_n  > L \\end{cases}. \\]Prove that\n(i) $\\left\\{x_n\\right\\}$ is eventually periodic.\n(ii) The eventual fundamental period of $\\left\\{x_n\\right\\}$ is an odd integer which doesn't depend on the choice of $x_1$.", "problem_idx": "CMO2024-1", "model_prediction": {"proof": "**Notation and basic facts**  \n\nDefine  \n\n\\[\nf(x)=\\begin{cases}\n\\displaystyle \\bigl\\lfloor \\alpha x\\bigr\\rfloor & (x\\le L),\\\\[4mm]\n\\displaystyle \\Bigl\\lfloor \\frac{x}{\\alpha}\\Bigr\\rfloor & (x>L).\n\\end{cases}\n\\]\n\nThe recurrence is \\(x_{n+1}=f(x_n)\\;(n\\ge1)\\) with \\(x_1>L\\).  \nSince \\(x_2=\\bigl\\lfloor x_1/\\alpha\\bigr\\rfloor\\) is an integer, by induction every term from \\(x_2\\) onward is an integer.\n\n---\n\n### 1.  Preliminary estimates  \n\nFrom \\(L>\\dfrac{\\alpha^{2}}{\\alpha-1}\\) and \\(\\alpha>1\\),\n\n\\[\nL(\\alpha-1)>\\alpha^{2}\\;\\Longrightarrow\\; \\alpha L>L+\\alpha^{2}>L+1. \\tag{1}\n\\]\n\nSet  \n\n\\[\nM=\\bigl\\lfloor\\alpha L\\bigr\\rfloor ,\\qquad a=\\Bigl\\lfloor\\frac{L+1}{\\alpha}\\Bigr\\rfloor .\n\\]\n\nBecause \\(\\alpha L>L+1\\), we have \\(M\\ge L+1\\).  \nSince \\((L+1)/\\alpha<L\\) (using \\((1)\\): \\(\\alpha L>L+1\\) \u21d2 \\((L+1)/\\alpha<L\\)) and \\(\\alpha\\) is irrational, \\((L+1)/\\alpha\\) is not an integer; therefore \\(a\\le L-1\\).  \nAlso \\(L+1>\\alpha\\) \u21d2 \\((L+1)/\\alpha>1\\) \u21d2 \\(a\\ge1\\).  \nFrom \\(L>\\alpha^{2}/(\\alpha-1)\\) we also obtain \\(L>\\alpha\\).  \nThe irrationality of \\(\\alpha\\) guarantees that \\(\\alpha L\\) and \\((L+1)/\\alpha\\) are not integers, so  \n\n\\[\nM<\\alpha L,\\qquad a<\\frac{L+1}{\\alpha}. \\tag{2}\n\\]\n\n---\n\n### 2.  Part (i) \u2013 eventual periodicity  \n\nLet  \n\n\\[\nS=\\{1,2,\\dots ,M\\}.\n\\]\n\n**Lemma\u202f2.1**   \\(f(S)\\subseteq S\\).\n\n*Proof.*  Take \\(k\\in S\\).\n\n*If \\(k\\le L\\):*  \\(f(k)=\\lfloor\\alpha k\\rfloor\\).  Because \\(k\\ge1\\), \\(\\alpha k\\ge\\alpha>1\\) \u21d2 \\(f(k)\\ge1\\).  Also \\(\\alpha k\\le\\alpha L\\) \u21d2 \\(f(k)\\le\\lfloor\\alpha L\\rfloor=M\\).\n\n*If \\(k>L\\):*  then \\(L<k\\le M\\).  Since \\(L>\\alpha\\), \\(k/\\alpha>1\\) \u21d2 \\(f(k)=\\lfloor k/\\alpha\\rfloor\\ge1\\).  Moreover \\(k\\le M\\) and \\(M<\\alpha L\\) \u21d2 \\(k/\\alpha\\le M/\\alpha<L\\); hence \\(\\lfloor k/\\alpha\\rfloor\\le L-1\\le M\\).\n\nIn both cases \\(f(k)\\in S\\). \u220e  \n\n**Entering \\(S\\).**  Compute \\(x_2=\\lfloor x_1/\\alpha\\rfloor\\).  Because \\(x_1>L>\\alpha\\), \\(x_2\\ge1\\).\n\n*If \\(x_2\\le L\\):* then \\(1\\le x_2\\le L\\le M\\), so \\(x_2\\in S\\).\n\n*If \\(x_2>L\\):* while a term exceeds \\(L\\) we use the second branch: \\(x_{n+1}=\\lfloor x_n/\\alpha\\rfloor\\).  For such \\(x_n\\) we have \\(x_{n+1}<x_n\\) (since \\(\\alpha>1\\)).  Thus the values while \\(>L\\) form a strictly decreasing sequence of positive integers.  Such a sequence cannot be infinite; therefore there exists a smallest index \\(N\\ge2\\) with \\(x_N\\le L\\).  By minimality \\(x_{N-1}>L\\), hence \\(x_{N-1}\\ge L+1\\).  Then  \n\n\\[\nx_N=\\Bigl\\lfloor\\frac{x_{N-1}}{\\alpha}\\Bigr\\rfloor\\ge\\Bigl\\lfloor\\frac{L+1}{\\alpha}\\Bigr\\rfloor = a\\ge1,\n\\]\n\nand \\(x_N\\le L\\); consequently \\(x_N\\in S\\).\n\nThus in every case we find an index \\(N\\) with \\(x_N\\in S\\).\n\n**Conclusion of (i).**  By Lemma\u202f2.1, once we are in \\(S\\) we stay there: if \\(x_n\\in S\\) then \\(x_{n+1}=f(x_n)\\in S\\).  Hence \\(x_n\\in S\\) for all \\(n\\ge N\\).  \nBecause \\(S\\) is finite, among the infinitely many terms \\(x_N,x_{N+1},\\dots\\) two must be equal: say \\(x_i=x_j\\) with \\(i<j\\).  The recurrence being deterministic then yields \\(x_{i+k}=x_{j+k}\\) for all \\(k\\ge0\\); i.e. the sequence is **eventually periodic**. \u220e  \n\n---\n\n### 3.  Part (ii) \u2013 the eventual fundamental period is odd and independent of \\(x_1\\)  \n\nRefine the invariant set:\n\n\\[\nY=\\{a,\\;a+1,\\dots ,L\\},\\qquad I=\\{L+1,\\;L+2,\\dots ,M\\},\\qquad T=Y\\cup I.\n\\]\n\nNote that \\(Y\\cap I=\\varnothing\\), \\(T\\subseteq S\\), and \\(a\\in Y\\).\n\n---\n\n#### 3.1  Behaviour of \\(f\\) on \\(Y\\) and \\(I\\)\n\n**Lemma\u202f3.1**  \n\n1. If \\(y\\in Y\\) and \\(y>a\\), then \\(f(y)\\in I\\) and \\(f^{2}(y)=y-1\\).  \n2. If \\(k\\in I\\), then \\(f(k)\\in Y\\) and \\(f(k)\\ge a\\).  \n3. \\(f(a)\\in Y\\) (and \\(f(a)\\ge a\\)).\n\n*Proof.*  \n\n1. Because \\(y\\le L\\), \\(f(y)=\\lfloor\\alpha y\\rfloor\\).  \n   From \\(a=\\bigl\\lfloor\\frac{L+1}{\\alpha}\\bigr\\rfloor\\) we have \\(a<\\frac{L+1}{\\alpha}<a+1\\).  Since \\(y\\ge a+1\\), it follows that \\(y>\\frac{L+1}{\\alpha}\\), hence \\(\\alpha y>L+1\\).  \n   Also \\(\\alpha y\\le\\alpha L\\); therefore \\(L+1\\le\\lfloor\\alpha y\\rfloor\\le M\\), i.e. \\(f(y)\\in I\\).  \n\n   \\(\\alpha\\) is irrational, so \\(\\alpha y\\) is not an integer; thus \\(\\alpha y-1<\\lfloor\\alpha y\\rfloor<\\alpha y\\).  Dividing by \\(\\alpha\\) gives  \n\n   \\[\n   y-\\frac1\\alpha<\\frac{f(y)}{\\alpha}<y .\n   \\]\n\n   Because \\(1/\\alpha<1\\), we obtain \\(y-1<f(y)/\\alpha<y\\).  Now \\(f(y)\\in I\\), therefore the next iteration uses the second branch:  \n\n   \\[\n   f^{2}(y)=\\Bigl\\lfloor\\frac{f(y)}{\\alpha}\\Bigr\\rfloor = y-1,\n   \\]  \n   the floor of a number strictly between \\(y-1\\) and \\(y\\) being \\(y-1\\).\n\n2. For \\(k\\in I\\) we have \\(f(k)=\\lfloor k/\\alpha\\rfloor\\).  \n   \\(k\\ge L+1\\) \u21d2 \\(k/\\alpha\\ge (L+1)/\\alpha\\) \u21d2 \\(f(k)\\ge a\\).  \n   Since \\(k\\le M\\) and \\(M<\\alpha L\\), we get \\(k/\\alpha\\le M/\\alpha<L\\); thus \\(\\lfloor k/\\alpha\\rfloor\\le L-1\\).  Consequently \\(f(k)\\in Y\\) and \\(f(k)\\ge a\\).\n\n3. Because \\(a\\le L\\), \\(f(a)=\\lfloor\\alpha a\\rfloor\\).  From \\(a<\\frac{L+1}{\\alpha}\\) we obtain \\(\\alpha a<L+1\\), so \\(f(a)\\le L\\).  Moreover \\(\\alpha>1\\) implies \\(\\alpha a>a\\); therefore \\(f(a)\\ge a\\).  Hence \\(f(a)\\in Y\\). \u220e  \n\n**Corollary\u202f3.2**   \\(f(T)\\subseteq T\\).  (Immediate from Lemma\u202f3.1.)\n\n---\n\n#### 3.2  The sequence eventually stays in \\(T\\)\n\nWe analyse \\(x_2=\\lfloor x_1/\\alpha\\rfloor\\).\n\n* **Case\u202fA:** \\(x_2\\le L\\) **and** \\(x_2\\ge a\\).  \n  Then \\(x_2\\in Y\\subseteq T\\).  By Corollary\u202f3.2 the whole tail from index\u202f2 stays in \\(T\\); we may take \\(N=2\\).\n\n* **Case\u202fB:** \\(x_2\\le L\\) **and** \\(x_2<a\\).  \n\n  Set \\(t=\\bigl\\lfloor L/\\alpha\\bigr\\rfloor\\).  Because \\((L+1)/\\alpha = L/\\alpha+1/\\alpha\\) with \\(0<1/\\alpha<1\\), the floor of \\((L+1)/\\alpha\\) is either \\(t\\) or \\(t+1\\); hence \\(a\\in\\{t,\\;t+1\\}\\).  \n\n  From \\(x_2=\\lfloor x_1/\\alpha\\rfloor\\ge\\lfloor L/\\alpha\\rfloor=t\\) and \\(x_2<a\\), we cannot have \\(a=t\\) (otherwise \\(x_2<t\\) contradicts \\(x_2\\ge t\\)).  Thus \\(a=t+1\\) and consequently \\(x_2=t\\).  \n\n  Because \\(t<L\\) (as \\(L/\\alpha<L\\)), the first branch applies to \\(t\\): \\(x_3=f(t)=\\lfloor\\alpha t\\rfloor\\).  \n\n  *Upper bound:* \\(\\alpha t\\le\\alpha\\cdot(L/\\alpha)=L\\) \u21d2 \\(x_3\\le L\\).  \n  *Lower bound:* From \\(L>\\dfrac{\\alpha^{2}}{\\alpha-1}\\) we obtain \\(\\dfrac{L}{\\alpha}>\\dfrac{\\alpha}{\\alpha-1}\\); hence  \n\n  \\[\n  \\frac{L}{\\alpha}-1>\\frac{1}{\\alpha-1}.\n  \\]\n\n  Since \\(t>\\dfrac{L}{\\alpha}-1\\) (property of the floor), we have \\(t>\\dfrac{1}{\\alpha-1}\\), i.e. \\(t(\\alpha-1)>1\\), which is equivalent to \\(\\alpha t>t+1\\).  Therefore \\(\\lfloor\\alpha t\\rfloor\\ge t+1=a\\).  \n\n  Thus \\(a\\le x_3\\le L\\), so \\(x_3\\in Y\\subseteq T\\).  From index\u202f3 onward the sequence remains in \\(T\\); take \\(N=3\\).\n\n* **Case\u202fC:** \\(x_2>L\\).  \n\n  As in part\u202f(i), there exists a smallest index \\(N\\ge2\\) with \\(x_N\\le L\\).  Minimality gives \\(x_{N-1}>L\\), hence \\(x_{N-1}\\ge L+1\\).  Then  \n\n  \\[\n  x_N=\\Bigl\\lfloor\\frac{x_{N-1}}{\\alpha}\\Bigr\\rfloor\\ge\\Bigl\\lfloor\\frac{L+1}{\\alpha}\\Bigr\\rfloor = a,\n  \\]\n\n  and \\(x_N\\le L\\); therefore \\(x_N\\in Y\\subseteq T\\).  By Corollary\u202f3.2, for all \\(n\\ge N\\) we have \\(x_n\\in T\\).\n\nIn every possible situation we have found an index \\(N\\) such that \\(x_N\\in T\\) and \\(x_n\\in T\\) for all \\(n\\ge N\\).\n\n---\n\n#### 3.3  All elements of \\(T\\) are attracted to \\(a\\)\n\n**Lemma\u202f3.3**  For every \\(t\\in T\\) there exists a non\u2011negative integer \\(m\\) with \\(f^{\\,m}(t)=a\\).\n\n*Proof.*  \n\n- If \\(t=a\\), take \\(m=0\\).  \n- If \\(t\\in Y\\) and \\(t>a\\), Lemma\u202f3.1(1) gives \\(f^{2}(t)=t-1\\).  Repeating this operation reduces the value by one every two steps; after \\(2(t-a)\\) applications we reach \\(a\\).  \n- If \\(t\\in I\\), Lemma\u202f3.1(2) yields \\(f(t)\\in Y\\).  Applying the previous case to \\(f(t)\\) provides an \\(m'\\) with \\(f^{\\,m'}(f(t))=a\\); then \\(m=m'+1\\) works. \u220e  \n\nApply Lemma\u202f3.3 to \\(x_N\\) (which lies in \\(T\\)).  There exists \\(m\\ge0\\) such that \\(x_{N+m}=a\\).  Set \\(K=N+m\\).  By the definition of the recurrence,\n\n\\[\nx_{K+n}=f^{\\,n}(a)\\qquad\\text{for all }n\\ge0. \\tag{1}\n\\]\n\n---\n\n#### 3.4  The orbit of \\(a\\) and its period  \n\nLet \\(b=f(a)\\).  From Lemma\u202f3.1(3) we have \\(b\\in Y\\) and \\(b\\ge a\\).\n\n* **Subcase\u202f1:** \\(b=a\\).  Then \\(a\\) is a fixed point; its fundamental period is \\(p=1\\).\n\n* **Subcase\u202f2:** \\(b>a\\).  Put \\(d=b-a\\;(d\\ge1)\\).  \n\n  **Claim:** For \\(k=0,1,\\dots ,d-1\\),  \n\n  \\[\n  f^{\\,2k+1}(a)=b-k. \\tag{2}\n  \\]\n\n  *Proof by induction.*  For \\(k=0\\), (2) is \\(f(a)=b\\).  Assume (2) holds for some \\(k<d-1\\).  Then \\(y=f^{\\,2k+1}(a)=b-k\\) belongs to \\(Y\\) and satisfies \\(y>a\\) (because \\(b-k\\ge b-(d-2)=a+2\\)).  By Lemma\u202f3.1(1), \\(f^{2}(y)=y-1=b-(k+1)\\).  Hence \\(f^{\\,2(k+1)+1}(a)=f^{2}\\!\\bigl(f^{\\,2k+1}(a)\\bigr)=b-(k+1)\\), completing the induction. \u220e  \n\n  Taking \\(k=d-1\\) gives \\(f^{\\,2d-1}(a)=b-(d-1)=a+1\\).  \n  Applying Lemma\u202f3.1(1) to \\(y=a+1\\) yields \\(f^{2}(a+1)=a\\).  Consequently  \n\n  \\[\n  f^{\\,2d+1}(a)=a. \\tag{3}\n  \\]\n\n  We now verify that no smaller positive integer can be a period of \\(a\\).  \n\n  *Odd candidates:* If \\(q=2k+1\\) with \\(0\\le k<d\\), then (2) gives \\(f^{q}(a)=b-k>a\\), so \\(f^{q}(a)\\neq a\\).  \n\n  *Even candidates:* If \\(q=2k\\) with \\(1\\le k\\le d\\), then \\(f^{\\,2k-1}(a)=b-(k-1)>a\\) (by (2) for \\(k-1\\le d-1\\)).  Since \\(f^{\\,2k-1}(a)\\in Y\\) and \\(>a\\), Lemma\u202f3.1(1) tells us that \\(f^{\\,2k}(a)\\in I\\); but \\(a\\in Y\\) and \\(Y\\cap I=\\varnothing\\), hence \\(f^{\\,2k}(a)\\neq a\\).\n\n  Therefore the smallest positive integer with \\(f^{p}(a)=a\\) is \\(p=2d+1\\).\n\nIn both subcases \\(p\\) is **odd** (1 is odd, and \\(2d+1\\) is odd).\n\n---\n\n#### 3.5  The eventual fundamental period of \\(\\{x_n\\}\\)\n\nFrom (1) and \\(f^{p}(a)=a\\) we obtain \\(x_{K+p}=f^{p}(a)=a=x_K\\), and by induction  \n\n\\[\nx_{K+n+p}=x_{K+n}\\qquad\\text{for all }n\\ge0.\n\\]\n\nThus the tail \\(\\{x_n\\}_{n\\ge K}\\) is periodic with period \\(p\\); the whole sequence is eventually periodic with period \\(p\\).\n\nNow we prove that \\(p\\) is the *fundamental* eventual period.  Suppose, for contradiction, that there existed a positive integer \\(q<p\\) such that the sequence were eventually periodic with period \\(q\\); i.e. there is an index \\(N_0\\) with \\(x_{n+q}=x_n\\) for all \\(n\\ge N_0\\).  \n\nChoose an integer \\(\\ell\\) large enough so that \\(n=K+\\ell p\\ge\\max(K,N_0)\\).  Because the tail from \\(K\\) is \\(p\\)-periodic, \\(x_n=a\\).  Then  \n\n\\[\na=x_n=x_{n+q}=f^{\\,q}(x_n)=f^{\\,q}(a).\n\\]\n\nHence \\(f^{q}(a)=a\\).  But \\(p\\) is the smallest positive integer with this property (the fundamental period of \\(a\\)), a contradiction to \\(q<p\\).  Therefore no such \\(q\\) can exist; \\(p\\) is indeed the smallest eventual period, i.e. the eventual fundamental period of \\(\\{x_n\\}\\).\n\n---\n\n#### 3.6  Independence of the initial value  \n\nThe numbers  \n\n\\[\na=\\Bigl\\lfloor\\frac{L+1}{\\alpha}\\Bigr\\rfloor,\\qquad b=\\lfloor\\alpha a\\rfloor\n\\]\n\nare determined solely by \\(\\alpha\\) and the integer \\(L\\).  The period \\(p\\) is either \\(1\\) (if \\(b=a\\)) or \\(2(b-a)+1\\) (if \\(b>a\\)).  Hence \\(p\\) does **not** depend on the choice of \\(x_1\\).\n\n\u220e  \n\n---", "average_automatic_rating": 1.0, "human_rating": 21}}
{"question": "Let $ABC$ be a triangle with incenter $I$. Denote the midpoints of $AI$, $AC$ and $CI$ by $L$, $M$ and $N$ respectively. Point $D$ lies on segment $AM$ such that $BC= BD$. Let the incircle of triangle $ABD$ be tangent to $AD$ and $BD$ at $E$ and $F$ respectively. Denote the circumcenter of triangle $AIC$ by $J$, and the circumcircle of triangle $JMD$ by $\\omega$. Lines $MN$ and $JL$ meet $\\omega$ again at $P$ and $Q$ respectively. Prove that $PQ$, $LN$ and $EF$ are concurrent.", "problem_idx": "CMO2024-2", "model_prediction": {"proof": "**1. Coordinate set\u2011up.**  \nPlace the midpoint \\(M\\) of \\(AC\\) at the origin and let \\(AC\\) lie on the \\(x\\)-axis.  \nWrite  \n\n\\[\nA=(-t,0),\\qquad C=(t,0)\\quad(t>0),\\qquad B=(p,q)\\quad(q>0).\n\\]\n\nDenote the side lengths  \n\n\\[\na = BC = \\sqrt{(p-t)^2+q^2},\\qquad \nc = AB = \\sqrt{(p+t)^2+q^2},\\qquad \nb = AC = 2t,\n\\]\nand let  \n\n\\[\ns = a+b+c = a+2t+c.\n\\]\n\n**2. Point \\(D\\).**  \n\\(D\\) lies on segment \\(AM\\) and satisfies \\(BD = BC = a\\). Points on \\(AM\\) have the form \\((x,0)\\) with \\(-t\\le x\\le 0\\).  \nThe condition \\((p-x)^2+q^2 = (p-t)^2+q^2\\) gives \\((p-x)^2 = (p-t)^2\\); hence  \n\n\\[\np-x = \\pm(p-t).\n\\]\n\nThe choice \\(p-x = p-t\\) yields \\(x=t\\) (point \\(C\\)), which is not on \\(AM\\). The other choice gives  \n\n\\[\nx = 2p-t.\n\\]\n\nThus \\(D = (d,0)\\) with  \n\n\\[\nd = 2p-t.\n\\]\n\nFor \\(D\\) to belong to the segment \\(AM\\) we need \\(-t\\le d\\le0\\), i.e. \\(0\\le p\\le t/2\\).  \nA non\u2011degenerate configuration (the incircle of \\(\\triangle ABD\\) exists and \\(\\omega\\) is defined) requires \\(D\\) distinct from \\(A\\) and \\(M\\); therefore we take  \n\n\\[\n0<p<\\frac{t}{2}\\qquad(\\text{hence }d<0).\n\\]\n\n(The degenerate cases \\(p=0\\) or \\(p=t/2\\) are irrelevant to the problem.)\n\n**3. Incenter \\(I\\) and midpoints \\(L,N\\).**  \nUsing the barycentric expression of the incenter,  \n\n\\[\nI = \\frac{aA+bB+cC}{s}\n   = \\Bigl(\\frac{-at+2tp+ct}{s},\\;\\frac{2tq}{s}\\Bigr)\n   = \\Bigl(\\frac{t(2p+c-a)}{s},\\;\\frac{2tq}{s}\\Bigr).\n\\]\n\nMidpoints:\n\n\\[\nL = \\frac{A+I}{2}\n   = \\Bigl(\\frac{t(p-a-t)}{s},\\;\\frac{tq}{s}\\Bigr),\\qquad\nN = \\frac{C+I}{2}\n   = \\Bigl(\\frac{t(p+t+c)}{s},\\;\\frac{tq}{s}\\Bigr).\n\\]\n\nConsequently \\(L\\) and \\(N\\) have the same \\(y\\)-coordinate, so \\(LN\\) is the horizontal line  \n\n\\[\ny = L_y = \\frac{tq}{s}. \\tag{LN}\n\\]\n\nFor later use we introduce  \n\n\\[\nU = p+t+c.\n\\]\n\nNotice that  \n\n\\[\nI-A = \\Bigl(\\frac{2tU}{s},\\;\\frac{2tq}{s}\\Bigr) \\sim (U,q).\n\\]\n\n**4. Circumcenter \\(J\\) of \\(\\triangle AIC\\).**  \nBecause \\(A\\) and \\(C\\) are symmetric with respect to the \\(y\\)-axis, the perpendicular bisector of \\(AC\\) is the \\(y\\)-axis; hence \\(J\\) lies on the \\(y\\)-axis:  \n\n\\[\nJ = (0,\\;y_J)\\quad\\text{for some }y_J.\n\\]\n\nSince \\(J\\) is equidistant from \\(A\\) and \\(I\\), it belongs to the perpendicular bisector of \\(AI\\).  \nThe midpoint of \\(AI\\) is \\(L\\), therefore the line \\(JL\\) is that perpendicular bisector; thus \\((J-L)\\perp (I-A)\\):\n\n\\[\n(J-L)\\cdot(I-A)=0.\n\\]\n\nSubstituting \\(J-L = (-L_x,\\;y_J-L_y)\\) and \\(I-A = (2tU/s,\\;2tq/s)\\) and multiplying by \\(s/(2t)\\) we obtain  \n\n\\[\n-\\,L_xU + (y_J-L_y)q = 0,\n\\]\n\ni.e.  \n\n\\[\nq\\,y_J = L_xU + qL_y. \\tag{2}\n\\]\n\n**5. Circle \\(\\omega\\) (circumcircle of \\(\\triangle JMD\\)).**  \nWe have \\(M=(0,0)\\), \\(J=(0,y_J)\\), \\(D=(d,0)\\). Then  \n\n\\[\n(M-J)\\cdot(M-D) = (0,-y_J)\\cdot(-d,0)=0,\n\\]\n\nso \\(MJ\\perp MD\\); thus \\(\\triangle JMD\\) is right\u2011angled at \\(M\\) and its circumcircle has diameter \\(JD\\).  \nA convenient equation for this circle is  \n\n\\[\n(X-J)\\cdot(X-D)=0. \\tag{3}\n\\]\n\nIndeed, (3) is satisfied by \\(X=J,\\;D\\) and, as just verified, by \\(X=M\\); it describes exactly the circle with diameter \\(JD\\).\n\n**6. Point \\(P\\) \u2013 second intersection of \\(MN\\) with \\(\\omega\\).**  \nThe line \\(MN\\) passes through the origin and through \\(N = \\bigl(\\frac{tU}{s},\\frac{tq}{s}\\bigr)=\\frac{t}{s}(U,q)\\). Hence a parametric form is  \n\n\\[\nX = \\lambda\\,(U,q)\\qquad(\\lambda\\in\\mathbb R).\n\\]\n\nInsert into (3):\n\n\\[\n\\lambda^2(U^2+q^2) - \\lambda\\,(U d + q y_J)=0.\n\\]\n\nThe root \\(\\lambda=0\\) corresponds to \\(M\\); the other gives  \n\n\\[\n\\lambda_P = \\frac{U d + q y_J}{U^2+q^2}. \\tag{4}\n\\]\n\nTherefore  \n\n\\[\nP = \\lambda_P\\,(U,q). \\tag{5}\n\\]\n\n**7. Point \\(Q\\) \u2013 second intersection of \\(JL\\) with \\(\\omega\\).**  \nBecause \\(JL\\) is perpendicular to \\(AI\\) and a direction vector of \\(AI\\) is \\((U,q)\\), we can take a perpendicular direction \\((q,-U)\\).  \nParameterize \\(JL\\) as  \n\n\\[\nX = J + \\mu\\,(q,-U) = (\\mu q,\\; y_J - \\mu U).\n\\]\n\nThat \\(L\\) belongs to this line follows from (2): with \\(\\mu_0 = L_x/q\\) we have \\(\\mu_0 q = L_x\\) and, using (2), \\(y_J - \\mu_0 U = y_J - \\frac{L_x}{q}U = L_y\\).\n\nSubstituting the parametrisation into (3) gives  \n\n\\[\n\\mu^2(U^2+q^2) - \\mu\\,(q d + U y_J)=0.\n\\]\n\nThe solution \\(\\mu=0\\) corresponds to \\(J\\); the other is  \n\n\\[\n\\mu_Q = \\frac{q d + U y_J}{U^2+q^2}. \\tag{6}\n\\]\n\nThus  \n\n\\[\nQ = (\\mu_Q q,\\; y_J - \\mu_Q U). \\tag{7}\n\\]\n\n**8. Intersection \\(X = PQ\\cap LN\\).**  \nRecall that \\(LN\\) is the horizontal line \\(y = L_y = tq/s\\).  Write \\(X = (x, L_y)\\).  \nWe first determine the slope of \\(PQ\\).  Let  \n\n\\[\n\\Delta = U^2+q^2.\n\\]\n\nFrom (4)\u2013(7) we compute  \n\n\\[\n\\begin{aligned}\n\\Delta x &= \\mu_Q q - \\lambda_P U\n         = \\frac{q d + U y_J}{\\Delta}\\,q - \\frac{U d + q y_J}{\\Delta}\\,U\n         = \\frac{d\\,(q^2-U^2)}{\\Delta},\\\\[4pt]\n\\Delta y &= (y_J - \\mu_Q U) - \\lambda_P q\n         = y_J - \\frac{q d + U y_J}{\\Delta}\\,U - \\frac{U d + q y_J}{\\Delta}\\,q\\\\\n         &= y_J - \\frac{2U q d + \\Delta y_J}{\\Delta}\n         = -\\,\\frac{2U q d}{\\Delta}.\n\\end{aligned}\n\\]\n\n(Notice that \\(d\\neq0\\) because \\(p<t/2\\) and \\(p>0\\); also \\(U>q\\) since \\(c=\\sqrt{(p+t)^2+q^2}>q\\) and \\(U=p+t+c>q\\). Hence \\(\\Delta x\\neq0\\) and the slope is well defined.)\n\nThus the slope of \\(PQ\\) is  \n\n\\[\nm = \\frac{\\Delta y}{\\Delta x} = \\frac{-2U q d/\\Delta}{d\\,(q^2-U^2)/\\Delta}\n   = -\\frac{2U q}{q^2-U^2}.\n\\]\n\nNow the line through \\(P\\) with this slope has equation  \n\n\\[\ny - \\lambda_P q = m\\,(x - \\lambda_P U).\n\\]\n\nSetting \\(y = L_y\\) and solving for \\(x\\) yields  \n\n\\[\nx = \\lambda_P U + \\frac{L_y - \\lambda_P q}{m}.\n\\]\n\nBecause \\(1/m = -(q^2-U^2)/(2U q)\\),\n\n\\[\nx = \\lambda_P U - (L_y - \\lambda_P q)\\,\\frac{q^2-U^2}{2U q}.\n\\]\n\nExpand and collect the terms containing \\(\\lambda_P\\):\n\n\\[\n\\begin{aligned}\nx &= \\lambda_P U - \\frac{L_y(q^2-U^2)}{2U q} + \\lambda_P q\\,\\frac{q^2-U^2}{2U q}\\\\[4pt]\n  &= \\lambda_P\\!\\left(U + \\frac{q^2-U^2}{2U}\\right) - \\frac{L_y(q^2-U^2)}{2U q}\\\\[4pt]\n  &= \\lambda_P\\frac{U^2+q^2}{2U} - \\frac{L_y(q^2-U^2)}{2U q}.\n\\end{aligned}\n\\]\n\nUsing \\(\\lambda_P\\Delta = U d + q y_J\\) (from (4)) we obtain  \n\n\\[\nx = \\frac{U d + q y_J}{2U} - \\frac{L_y(q^2-U^2)}{2U q}.\n\\]\n\nNow apply relation (2), \\(q y_J = L_x U + q L_y\\):\n\n\\[\n\\frac{U d + q y_J}{2U} = \\frac{d}{2} + \\frac{L_x}{2} + \\frac{q L_y}{2U}.\n\\]\n\nHence  \n\n\\[\nx = \\frac{d}{2} + \\frac{L_x}{2} + \\frac{q L_y}{2U} - \\frac{L_y(q^2-U^2)}{2U q}.\n\\]\n\nCombine the \\(L_y\\)\u2011terms:\n\n\\[\n\\frac{q L_y}{2U} - \\frac{L_y(q^2-U^2)}{2U q}\n   = \\frac{L_y}{2U}\\!\\left(q - \\frac{q^2-U^2}{q}\\right)\n   = \\frac{L_y}{2U}\\!\\left(\\frac{U^2}{q}\\right)\n   = \\frac{U L_y}{2q}.\n\\]\n\nTherefore  \n\n\\[\nx = \\frac{d}{2} + \\frac{L_x}{2} + \\frac{U L_y}{2q}. \\tag{8}\n\\]\n\nFinally substitute the explicit coordinates:\n\n\\[\nd = 2p-t,\\qquad\nL_x = \\frac{t(p-a-t)}{s},\\qquad\nL_y = \\frac{tq}{s},\\qquad\nU = p+t+c.\n\\]\n\nThen  \n\n\\[\n\\begin{aligned}\nx &= \\frac{2p-t}{2} + \\frac{1}{2}\\,\\frac{t(p-a-t)}{s} + \\frac{t(p+t+c)}{2s}\\\\[4pt]\n  &= \\frac{2p-t}{2} + \\frac{t}{2s}\\bigl[(p-a-t)+(p+t+c)\\bigr]\\\\[4pt]\n  &= \\frac{2p-t}{2} + \\frac{t(2p - a + c)}{2s}. \\tag{9}\n\\end{aligned}\n\\]\n\nThus  \n\n\\[\nX = \\bigl(x,\\;L_y\\bigr) = \\Bigl(\\frac{2p-t}{2} + \\frac{t(2p - a + c)}{2s},\\; \\frac{tq}{s}\\Bigr). \\tag{10}\n\\]\n\n**9. Points \\(E\\) and \\(F\\) \u2013 tangency points of the incircle of \\(\\triangle ABD\\).**  \nFor \\(\\triangle ABD\\) we have  \n\n\\[\nAB = c,\\quad BD = a,\\quad AD = |d-(-t)| = 2p.\n\\]\n\nIts semiperimeter is  \n\n\\[\ns_1 = \\frac{a+2p+c}{2}.\n\\]\n\nStandard incircle properties give  \n\n\\[\nAE = s_1 - a = \\frac{2p + c - a}{2},\\qquad\nBF = s_1 - AD = \\frac{a + c - 2p}{2}.\n\\]\n\nSince \\(A=(-t,0)\\) and \\(D=(d,0)\\) lie on the \\(x\\)-axis, \\(E\\) is also on this axis:\n\n\\[\nE = (-t + AE,\\;0) = \\Bigl(\\frac{c + 2p - a - 2t}{2},\\;0\\Bigr). \\tag{11}\n\\]\n\nVector \\(\\overrightarrow{BD} = (d-p,\\,-q) = (p-t,\\,-q)\\).  Hence  \n\n\\[\nF = B + \\frac{BF}{BD}\\,\\overrightarrow{BD}\n    = (p,q) + \\frac{a + c - 2p}{2a}\\,(p-t,\\,-q).\n\\]\n\nConsequently  \n\n\\[\nx_F = p + \\frac{(a + c - 2p)(p-t)}{2a},\\qquad\ny_F = q\\Bigl(1 - \\frac{a + c - 2p}{2a}\\Bigr)\n     = q\\,\\frac{a - c + 2p}{2a}. \\tag{12}\n\\]\n\n**10. Proving that \\(X\\) lies on \\(EF\\).**  \nBecause \\(LN\\) is horizontal, \\(X\\) has ordinate \\(L_y\\).  Points \\(E\\), \\(F\\), \\(X\\) are collinear iff  \n\n\\[\n(x - x_E)\\,y_F = L_y\\,(x_F - x_E). \\tag{13}\n\\]\n\nSubstituting \\(y_F = q\\,\\dfrac{a-c+2p}{2a}\\) and \\(L_y = \\dfrac{tq}{s}\\) and cancelling the common factor \\(q>0\\) yields  \n\n\\[\n(x - x_E)\\,\\frac{a-c+2p}{2a} = \\frac{t}{s}\\,(x_F - x_E).\n\\]\n\nMultiplying by \\(2a s\\) we obtain an equivalent equation  \n\n\\[\ns\\,(a - c + 2p)\\,(x - x_E) = 2a t\\,(x_F - x_E). \\tag{14}\n\\]\n\nNow insert the expressions for \\(x\\), \\(x_E\\) and \\(x_F\\).  From (9) and (11)\n\n\\[\nx - x_E = \\frac{a - c + t}{2} + \\frac{t(2p - a + c)}{2s}. \\tag{15}\n\\]\n\nHence  \n\n\\[\n\\begin{aligned}\ns\\,(a - c + 2p)(x - x_E)\n&= s\\,(a - c + 2p)\\!\\left(\\frac{a - c + t}{2} + \\frac{t(2p - a + c)}{2s}\\right)\\\\[4pt]\n&= \\frac{a - c + 2p}{2}\\Bigl[\\,s\\,(a - c + t) + t(2p - a + c)\\Bigr].\n\\end{aligned}\n\\]\n\nExpand the bracket using \\(s = a+2t+c\\):\n\n\\[\n\\begin{aligned}\ns\\,(a - c + t) + t(2p - a + c)\n&= (a+2t+c)(a - c + t) + t(2p - a + c)\\\\\n&= a^2 + 2a t + 2t^2 - c^2 + 2p t.\n\\end{aligned}\n\\]\n\nFrom the coordinates we have the simple relation  \n\n\\[\nc^2 - a^2 = (p+t)^2+q^2 - \\bigl[(p-t)^2+q^2\\bigr] = 4pt,\n\\]\nso \\(a^2 - c^2 = -4pt\\).  Substituting this,\n\n\\[\ns\\,(a - c + t) + t(2p - a + c) = -4pt + 2a t + 2t^2 + 2p t\n                               = 2t\\,(a + t - p).\n\\]\n\nTherefore  \n\n\\[\ns\\,(a - c + 2p)(x - x_E) = \\frac{a - c + 2p}{2}\\cdot 2t\\,(a + t - p)\n                         = t\\,(a - c + 2p)(a - p + t). \\tag{16}\n\\]\n\nNow compute the right\u2011hand side of (14).  From (11) and (12),\n\n\\[\nx_F - x_E = p + \\frac{(a + c - 2p)(p-t)}{2a} - \\frac{c + 2p - a - 2t}{2}.\n\\]\n\nWriting everything over the common denominator \\(2a\\) gives  \n\n\\[\nx_F - x_E = \\frac{N}{2a},\n\\]\n\nwhere  \n\n\\[\nN = a^2 + a(p+t) + c(p-t) - a c - 2p^2 + 2p t. \\tag{17}\n\\]\n\nConsequently  \n\n\\[\n2a t\\,(x_F - x_E) = 2a t\\cdot\\frac{N}{2a} = t N. \\tag{18}\n\\]\n\nIt remains to check that  \n\n\\[\nN = (a - c + 2p)(a - p + t).\n\\]\n\nExpanding the right\u2011hand side:\n\n\\[\n\\begin{aligned}\n(a - c + 2p)(a - p + t)\n&= a(a-p+t) - c(a-p+t) + 2p(a-p+t)\\\\\n&= a^2 - a p + a t - a c + c p - c t + 2a p - 2p^2 + 2p t\\\\\n&= a^2 + a p + a t - a c + c p - c t - 2p^2 + 2p t,\n\\end{aligned}\n\\]\n\nwhich is exactly the expression (17).  Hence \\(t N = t\\,(a - c + 2p)(a - p + t)\\).\n\nComparing (16) and (18) we see that (14) holds, and therefore (13) is satisfied.  Thus \\(X\\) lies on line \\(EF\\).\n\n**11. Conclusion.**  \nWe have shown that the point \\(X = PQ\\cap LN\\) also belongs to \\(EF\\).  Hence the three lines \\(PQ,\\;LN,\\;EF\\) are concurrent (they intersect at \\(X\\)).  \u220e", "average_automatic_rating": 1.0, "human_rating": 21}}
{"question": "Let \\(a_1, a_2, \\ldots, a_n\\) be integers such that \\(a_1 > a_2 > \\cdots > a_n > 1\\). Let \\(M = \\operatorname{lcm} \\left( a_1, a_2, \\ldots, a_n \\right)\\). For any finite nonempty set $X$ of positive integers, define\\[ f(X) = \\min_{1 \\leqslant i \\leqslant n} \\sum_{x \\in X} \\left\\{ \\frac{x}{a_i} \\right\\}. \\]Such a set $X$ is called minimal if for every proper subset $Y$ of it, $f(Y) < f(X)$ always holds.\n\nSuppose $X$ is minimal and $f(X) \\geqslant \\frac{2}{a_n}$. Prove that\\[ |X| \\leqslant f(X) \\cdot M. \\]", "problem_idx": "CMO2024-3", "model_prediction": {"proof": "**Notation**  \nFor a finite non\u2011empty set \\(X\\subset\\mathbb N\\) write  \n\n\\[\nS_i(X)=\\sum_{x\\in X}\\Bigl\\{\\frac{x}{a_i}\\Bigr\\}\\qquad(1\\le i\\le n),\\qquad \nf(X)=\\min_{1\\le i\\le n}S_i(X).\n\\]\n\nThe integers \\(a_1>a_2>\\dots >a_n>1\\) are fixed and  \n\n\\[\nM=\\operatorname{lcm}(a_1,a_2,\\dots ,a_n).\n\\]\n\n---\n\n### 1.  No element of \\(X\\) is a multiple of \\(M\\)\n\nAssume that some \\(x\\in X\\) satisfies \\(M\\mid x\\).  \n\n* If \\(|X|>1\\) then \\(Y=X\\setminus\\{x\\}\\) is a non\u2011empty proper subset and  \n  \\(S_i(Y)=S_i(X)\\) for every \\(i\\) (because \\(\\{x/a_i\\}=0\\)). Hence \\(f(Y)=f(X)\\), contradicting minimality.  \n\n* If \\(X=\\{x\\}\\) then \\(f(X)=0\\), but the hypothesis says \\(f(X)\\ge 2/a_n>0\\), impossible.  \n\nThus every \\(x\\in X\\) has a remainder \\(t_x:=x\\bmod M\\) belonging to \\(\\{1,2,\\dots ,M-1\\}\\) and  \n\n\\[\n\\Bigl\\{\\frac{x}{a_i}\\Bigr\\}=\\Bigl\\{\\frac{t_x}{a_i}\\Bigr\\}\\qquad(\\forall i).\n\\]\n\n---\n\n### 2.  A useful lemma  \n\nFor \\(t\\in\\{1,\\dots ,M-1\\}\\) define  \n\n\\[\ng(t)=\\sum_{i=1}^{n}\\Bigl\\{\\frac{t}{a_i}\\Bigr\\}.\n\\]\n\n**Lemma 1.**  \\(g(t)\\ge \\dfrac{n}{M}\\) for every such \\(t\\).\n\n*Proof by induction on \\(n\\).*  \n\n*Base \\(n=1\\).*  Then \\(M=a_1\\) and \\(g(t)=\\{t/a_1\\}=t/a_1\\ge 1/a_1=1/M\\).\n\n*Inductive step.*  Assume the statement true for any collection of \\(n-1\\) integers satisfying the same hypotheses.  \nLet \\(a_1>a_2>\\dots >a_n>1\\) and put  \n\n\\[\nM'=\\operatorname{lcm}(a_2,\\dots ,a_n),\\qquad g=\\gcd(a_1,M'),\\qquad a_1=gL,\\; M'=gL'\\;(\\gcd(L,L')=1).\n\\]\n\nThen \\(M=\\operatorname{lcm}(a_1,M')=L M'\\).\n\nTake \\(t\\) with \\(1\\le t\\le M-1\\) and write its division by \\(M'\\):  \n\n\\[\nt=qM'+r,\\qquad 0\\le q\\le L-1,\\;0\\le r\\le M'-1 .\n\\]\n\n---\n\n**Case A: \\(r=0\\).**  Then \\(t=qM'\\) with \\(1\\le q\\le L-1\\).  \nFor \\(i\\ge 2\\) we have \\(\\{t/a_i\\}=0\\) because \\(M'\\) is a multiple of each \\(a_i\\). Hence  \n\n\\[\ng(t)=\\Bigl\\{\\frac{qM'}{a_1}\\Bigr\\}\n     =\\Bigl\\{\\frac{qL'}{L}\\Bigr\\}\\ge\\frac{1}{L},\n\\]\n\nthe last inequality holding because \\(\\gcd(L,L')=1\\) and \\(q\\) is not a multiple of \\(L\\).  \n\nNow we need \\(\\frac{1}{L}\\ge\\frac{n}{M}= \\frac{n}{L M'}\\), i.e. \\(M'\\ge n\\).  \nThe numbers \\(a_2,\\dots ,a_n\\) are \\(n-1\\) distinct integers \\(>1\\). Their largest element \\(a_2\\) must be at least \\(n\\); otherwise all of them would lie in \\(\\{2,3,\\dots ,n-1\\}\\), a set of only \\(n-2\\) elements, contradicting distinctness. Thus \\(M'\\ge a_2\\ge n\\) and the desired inequality follows.\n\n---\n\n**Case B: \\(r>0\\).**  For \\(i\\ge 2\\) we have \\(\\{t/a_i\\}=\\{r/a_i\\}\\) (again because \\(M'\\) is a multiple of \\(a_i\\)).  \nBy the induction hypothesis applied to \\((a_2,\\dots ,a_n)\\) and its lcm \\(M'\\),\n\n\\[\nh(r):=\\sum_{i=2}^{n}\\Bigl\\{\\frac{r}{a_i}\\Bigr\\}\\ge\\frac{n-1}{M'}.\n\\]\n\nThus  \n\n\\[\ng(t)=\\Bigl\\{\\frac{qM'+r}{a_1}\\Bigr\\}+h(r)\\ge\n\\Bigl\\{\\frac{qM'+r}{a_1}\\Bigr\\}+\\frac{n-1}{M'}. \\tag{\u2217}\n\\]\n\nWe distinguish two sub\u2011cases.\n\n* **Sub\u2011case B1: \\(L\\ge 2\\).**  \n  Because \\((n-1)/M' = (n-1)L / M\\) and \\(L\\ge 2\\) implies \\((n-1)L \\ge n\\) (true for all \\(n\\ge 2\\)), we have \\((n-1)/M'\\ge n/M\\).  \n  Since the first term in (\u2217) is non\u2011negative, \\(g(t)\\ge n/M\\).\n\n* **Sub\u2011case B2: \\(L=1\\).**  \n  Then \\(a_1=g\\), \\(M=M'\\) and \\(k:=M/a_1\\) is an integer. Because \\(q\\le L-1=0\\), we have \\(q=0\\) and \\(t=r\\).  \n\n  *If \\(a_1\\nmid t\\)*, then \\(\\{t/a_1\\}\\ge 1/a_1 = k/M\\). Consequently  \n\n  \\[\n  g(t)=\\{t/a_1\\}+h(t)\\ge \\frac{k}{M}+\\frac{n-1}{M}= \\frac{k+n-1}{M}\\ge\\frac{n}{M}\\quad(\\text{since }k\\ge1).\n  \\]\n\n  *If \\(a_1\\mid t\\)*, write \\(t=a_1u\\) with \\(1\\le u\\le k-1\\) (if \\(k=1\\) this case cannot occur). Then \\(\\{t/a_1\\}=0\\) and  \n\n  \\[\n  g(t)=h(t)=\\sum_{i=2}^{n}\\Bigl\\{\\frac{a_1u}{a_i}\\Bigr\\}.\n  \\]\n\n  For \\(i\\ge2\\) set \\(b_i=M/a_i\\) (an integer). Using  \n\n  \\[\n  \\Bigl\\{\\frac{a_1u}{a_i}\\Bigr\\}=\\frac{((a_1u)b_i)\\bmod M}{M},\n  \\]\n  and the fact that \\(M=a_1k\\), we obtain  \n\n  \\[\n  ((a_1u)b_i)\\bmod M = a_1\\bigl((u b_i)\\bmod k\\bigr),\n  \\qquad\\text{hence}\\qquad\n  \\Bigl\\{\\frac{a_1u}{a_i}\\Bigr\\}=\\frac{(u b_i)\\bmod k}{k}.\n  \\]\n\n  Therefore  \n\n  \\[\n  h(t)=\\frac1k\\sum_{i=2}^{n}\\bigl((u b_i)\\bmod k\\bigr).\n  \\]\n\n  **Claim:** \\(\\displaystyle\\sum_{i=2}^{n}\\bigl((u b_i)\\bmod k\\bigr)\\ge 1\\).  \n\n  *Proof of the claim.*  Because \\(M=\\operatorname{lcm}(a_2,\\dots ,a_n)\\) and \\(a_1\\mid M\\), the integers \\(b_i=M/a_i\\) satisfy \\(\\gcd(b_2,\\dots ,b_n)=1\\). (If a common divisor \\(d>1\\) divided every \\(b_i\\), then \\(M/d\\) would be a common multiple of \\(a_2,\\dots ,a_n\\), contradicting the definition of \\(M\\) as the *least* common multiple.)  \n\n  By B\u00e9zout\u2019s identity there exist integers \\(\\lambda_i\\) with \\(\\sum_{i=2}^{n}\\lambda_i b_i =1\\). Multiplying by \\(u\\) gives  \n\n  \\[\n  u = \\sum_{i=2}^{n}\\lambda_i (u b_i).\n  \\]\n\n  If every term \\((u b_i)\\) were divisible by \\(k\\), the right\u2011hand side would be divisible by \\(k\\), forcing \\(k\\mid u\\). But \\(1\\le u\\le k-1\\) \u2013 contradiction. Hence at least one \\((u b_i)\\bmod k\\) is non\u2011zero, and because all are non\u2011negative integers, the sum is at least \\(1\\). \u220e  \n\n  Consequently \\(h(t)\\ge 1/k\\).  \n\n  Now recall that \\(a_1>a_2\\) and, as shown in Case\u202fA, \\(a_2\\ge n\\); thus \\(a_1\\ge n+1\\ge n\\). Hence  \n\n  \\[\n  h(t)\\ge\\frac1k=\\frac{a_1}{M}\\ge\\frac{n}{M}.\n  \\]\n\nIn every sub\u2011case we have proved \\(g(t)\\ge n/M\\), completing the induction. \u220e\n\n\n\n---\n\n### 3.  Applying the lemma  \n\nFor each \\(x\\in X\\) let \\(t_x=x\\bmod M\\;(1\\le t_x\\le M-1)\\).  Summing Lemma\u202f1 over the elements of \\(X\\) we obtain  \n\n\\[\n\\sum_{i=1}^{n}S_i(X)=\\sum_{x\\in X}g(t_x)\\ge |X|\\cdot\\frac{n}{M}. \\tag{1}\n\\]\n\n---\n\n### 4.  Integrality of \\(f\\cdot M\\)\n\nBecause each \\(a_i\\) divides \\(M\\), we can write \\(\\frac1{a_i}=\\frac{M/a_i}{M}\\).  Hence  \n\n\\[\n\\{x/a_i\\}=\\frac{x\\bmod a_i}{a_i}\n        =\\frac{(x\\bmod a_i)\\,(M/a_i)}{M}\\in\\frac{1}{M}\\mathbb Z .\n\\]\n\nTherefore every \\(S_i(X)\\) is a sum of such numbers, so \\(S_i(X)\\in\\frac{1}{M}\\mathbb Z\\).  \nThe minimum \\(f=f(X)\\) of finitely many numbers each in \\(\\frac{1}{M}\\mathbb Z\\) is itself of this form; write  \n\n\\[\nf=\\frac{K}{M}\\qquad(K\\in\\mathbb N,\\;K\\ge 1)\n\\]\n\n(the positivity follows from \\(f\\ge 2/a_n>0\\)).  From the hypothesis \\(f\\ge 2/a_n\\) we obtain  \n\n\\[\nK = fM \\ge \\frac{2}{a_n}\\,M = 2\\,\\frac{M}{a_n}\\ge 2,\n\\]\n\nso \\(K\\ge 2\\).\n\n---\n\n### 5.  Reduction to \\(|X|\\ge 2\\)\n\nIf \\(|X|=1\\) then the desired inequality \\(|X|\\le fM\\) becomes \\(1\\le K\\), which is true because \\(K\\ge2\\).  Hence the statement holds trivially for singletons.  \n**From now on we assume \\(|X|\\ge2\\).**  Then for any \\(x\\in X\\) the set \\(Y=X\\setminus\\{x\\}\\) is a non\u2011empty proper subset, and minimality yields \\(f(Y)<f\\).\n\n---\n\n### 6.  Auxiliary quantities and sets  \n\nDefine  \n\n\\[\nd_i=S_i(X)-f\\;\\;(\\ge0),\\qquad \\Delta=\\sum_{i=1}^{n}d_i,\n\\]\nand for each index \\(i\\)\n\n\\[\nT_i:=\\{\\,x\\in X\\mid \\{x/a_i\\}>d_i\\,\\}.\n\\]\n\n**Why the \\(T_i\\) cover \\(X\\).**  \nTake an arbitrary \\(x\\in X\\) and consider \\(Y=X\\setminus\\{x\\}\\).  Since \\(f(Y)<f\\), there exists an index \\(i\\) such that  \n\n\\[\nS_i(Y)=S_i(X)-\\{x/a_i\\}<f.\n\\]\n\nBut \\(S_i(X)=f+d_i\\); therefore \\((f+d_i)-\\{x/a_i\\}<f\\) \u21d2 \\(d_i<\\{x/a_i\\}\\).  Hence \\(x\\in T_i\\).  Consequently  \n\n\\[\nX=\\bigcup_{i=1}^{n} T_i. \\tag{2}\n\\]\n\n---\n\n### 7.  A crucial estimate for each \\(i\\)\n\nFix an index \\(i\\).  Split the sum \\(S_i=f+d_i\\) according to the partition \\(X=T_i\\cup(X\\setminus T_i)\\):\n\n\\[\nS_i=\\sum_{x\\in T_i}\\{x/a_i\\}+\\sum_{x\\notin T_i}\\{x/a_i\\}.\n\\]\n\n* If \\(x\\notin T_i\\) then \\(\\{x/a_i\\}\\le d_i\\).  \n* If \\(x\\in T_i\\) then \\(\\{x/a_i\\}>d_i\\).  Both \\(\\{x/a_i\\}\\) and \\(d_i\\) are multiples of \\(1/M\\); therefore their difference is at least \\(1/M\\), i.e. \\(\\{x/a_i\\}\\ge d_i+1/M.\n\nThus  \n\n\\[\n\\sum_{x\\in T_i}\\{x/a_i\\}\\ge |T_i|(d_i+1/M),\\qquad \n\\sum_{x\\notin T_i}\\{x/a_i\\}\\le (|X|-|T_i|)d_i .\n\\]\n\n**Adding these two inequalities** gives  \n\n\\[\nf+d_i = S_i \\ge |T_i|(d_i+1/M)+( |X|-|T_i|)d_i = |X|d_i+\\frac{|T_i|}{M}.\n\\]\n\nRearranging we obtain  \n\n\\[\nf \\ge (|X|-1)d_i+\\frac{|T_i|}{M}. \\tag{3}\n\\]\n\n---\n\n### 8.  Summation over all indices  \n\nSumming (3) for \\(i=1,\\dots ,n\\) yields  \n\n\\[\nn f \\ge (|X|-1)\\sum_{i=1}^{n}d_i + \\frac1M\\sum_{i=1}^{n}|T_i|\n      = (|X|-1)\\Delta + \\frac1M\\sum_{i=1}^{n}|T_i|. \\tag{4}\n\\]\n\nBecause the \\(T_i\\) cover \\(X\\) (relation (2)), every element of \\(X\\) is counted at least once in \\(\\sum_i|T_i|\\); hence  \n\n\\[\n\\sum_{i=1}^{n}|T_i|\\ge |X|. \\tag{5}\n\\]\n\nInserting (5) into (4) we get  \n\n\\[\nn f \\ge (|X|-1)\\Delta + \\frac{|X|}{M},\n\\qquad\\text{i.e.}\\qquad\n(|X|-1)\\Delta \\le n f - \\frac{|X|}{M}. \\tag{6}\n\\]\n\n---\n\n### 9.  Lower bound for \\(\\Delta\\) from Lemma\u202f1  \n\nFrom (1) we have  \n\n\\[\n\\sum_{i=1}^{n}S_i = n f + \\Delta \\ge |X|\\,\\frac{n}{M},\n\\]\n\nhence  \n\n\\[\n\\Delta \\ge n\\!\\left(\\frac{|X|}{M}-f\\right). \\tag{7}\n\\]\n\n(If the right\u2011hand side is negative the inequality is trivially true because \\(\\Delta\\ge0\\).)\n\n---\n\n### 10.  Deriving a numeric inequality  \n\nMultiply (7) by the positive number \\(|X|-1\\) and combine with (6):\n\n\\[\nn\\,(|X|-1)\\!\\left(\\frac{|X|}{M}-f\\right)\n   \\le (|X|-1)\\Delta \\le n f - \\frac{|X|}{M}.\n\\]\n\nNow multiply by \\(M\\) (which is positive) to clear denominators.  Set  \n\n\\[\nt:=|X|,\\qquad K:=fM\\ (\\text{an integer}).\n\\]\n\nThe inequality becomes  \n\n\\[\nn\\,(t-1)(t-K) \\le nK - t. \\tag{8}\n\\]\n\n---\n\n### 11.  The decisive contradiction  \n\nAssume, for the sake of contradiction, that \\(t>K\\).  Then  \n\n\\[\nt-K\\ge 1,\\qquad t-1\\ge K\\ (\\text{since }t\\ge K+1).\n\\]\n\nConsequently  \n\n\\[\n\\text{LHS of (8)} = n\\,(t-1)(t-K) \\ge n\\cdot K\\cdot 1 = nK.\n\\]\n\nOn the other hand, because \\(t\\ge K+1\\),\n\n\\[\n\\text{RHS of (8)} = nK - t \\le nK - (K+1).\n\\]\n\nThus (8) would imply  \n\n\\[\nnK \\le nK - (K+1),\n\\]\n\ni.e. \\(0 \\le -(K+1)\\), which is impossible (the right\u2011hand side is negative).  \nHence our assumption \\(t>K\\) cannot hold; we must have \\(t\\le K\\).\n\n---\n\n### 12.  Conclusion  \n\nWe have proved that for \\(|X|\\ge2\\) the inequality \\(|X|\\le fM\\) follows.  For \\(|X|=1\\) the inequality is obvious because \\(fM\\ge2>1\\).  Therefore **every** minimal set \\(X\\) with \\(f(X)\\ge 2/a_n\\) satisfies  \n\n\\[\n|X|\\le f(X)\\cdot M .\n\\]\n\n\u220e", "average_automatic_rating": 0.9296875, "human_rating": 0}}
{"question": "The fractional distance between two points $(x_1,y_1)$ and $(x_2,y_2)$ is defined as\\[ \\sqrt{ \\left\\| x_1 - x_2 \\right\\|^2 + \\left\\| y_1 - y_2 \\right\\|^2},\\]where $\\left\\| x \\right\\|$ denotes the distance between $x$ and its nearest integer. Find the largest real $r$ such that there exists four points on the plane whose pairwise fractional distance are all at least $r$.", "problem_idx": "CMO2024-4", "model_prediction": {"proof": "### 1.  Reduction to the unit square  \n\nFor a real number \\(x\\) let \\(\\|x\\|=\\min_{k\\in\\mathbb Z}|x-k|\\) be the distance to the nearest integer.  \nThe *fractional distance* between two points \\(P=(x_1,y_1),\\;Q=(x_2,y_2)\\) is  \n\n\\[\nd(P,Q)=\\sqrt{\\;\\|x_1-x_2\\|^{2}+\\|y_1-y_2\\|^{2}\\; } .\n\\]\n\nBecause \\(\\|t+n\\|=\\|t\\|\\) for every integer \\(n\\), adding an integer to a coordinate does **not** change any distance.  \nHence we may replace each coordinate by its fractional part and assume that all points lie in the unit square  \n\n\\[\n[0,1)^2 .\n\\]\n\nFor two numbers \\(u,v\\in[0,1)\\) we have  \n\n\\[\n\\|u-v\\|=\\min\\{\\,|u-v|,\\;1-|u-v|\\,\\}.\n\\]\n\n---\n\n### 2.  A configuration achieving a large mutual distance  \n\nSet  \n\n\\[\nt=\\frac{2-\\sqrt3}{2}\\approx0.133975 .\n\\]\n\nConsider the four points  \n\n\\[\nA=(0,0),\\qquad B=\\Bigl(\\frac12,\\,t\\Bigr),\\qquad\nC=\\Bigl(t,\\,\\frac12\\Bigr),\\qquad D=\\Bigl(\\frac12+t,\\;\\frac12+t\\Bigr).\n\\]\n\nAll coordinates are in \\([0,1)\\) because \\(t<\\frac12\\).  \nTheir pairwise fractional distances are  \n\n\\[\n\\begin{aligned}\nd(A,B)&=d(A,C)=d(B,D)=d(C,D)=\\sqrt{\\frac14+t^{2}},\\\\[2mm]\nd(A,D)&=d(B,C)=\\sqrt2\\Bigl(\\frac12-t\\Bigr).\n\\end{aligned}\n\\]\n\nNow  \n\n\\[\nt^{2}+\\frac14 =\\frac{(2-\\sqrt3)^{2}}{4}+\\frac14\n               =\\frac{4-4\\sqrt3+3}{4}+\\frac14\n               =\\frac{8-4\\sqrt3}{4}=2-\\sqrt3,\n\\]\n\n\\[\n\\sqrt2\\Bigl(\\frac12-t\\Bigr)=\\sqrt2\\Bigl(\\frac{\\sqrt3-1}{2}\\Bigr)\n                           =\\frac{\\sqrt6-\\sqrt2}{2},\n\\]\n\nand  \n\n\\[\n\\sqrt{2-\\sqrt3}= \\frac{\\sqrt6-\\sqrt2}{2}.\n\\]\n\nThus **all six distances are equal** to  \n\n\\[\nr_{0}= \\frac{\\sqrt6-\\sqrt2}{2}\\approx0.517638 .\n\\]\n\nConsequently  \n\n\\[\nr_{\\max}\\ge r_{0}.\n\\]\n\n---\n\n### 3.  Upper bound \u2013 no larger \\(r\\) is possible  \n\nAssume that four points \\(P_1,\\dots,P_4\\) in the unit square have pairwise fractional distances \\(\\ge r\\).  \nWe will prove that necessarily \\(r\\le r_{0}\\).\n\nIf \\(r\\le\\frac12\\) the inequality \\(r\\le r_{0}\\) is trivial because \\(r_{0}>\\frac12\\).  \nHence we may **suppose \\(r>\\frac12\\)** and define  \n\n\\[\n\\delta:=\\sqrt{r^{2}-\\frac14}\\;>\\;0 .\n\\]\n\n---\n\n#### Lemma\u202f1 (Coordinate\u2011wise lower bound)  \nFor any two points \\(P_i,P_j\\) let \\(\\Delta x=\\|x_i-x_j\\|\\) and \\(\\Delta y=\\|y_i-y_j\\|\\).  \nThen \\(\\Delta x\\ge\\delta\\) and \\(\\Delta y\\ge\\delta\\).\n\n*Proof.*  Because \\(\\|t\\|\\le\\frac12\\) for every real \\(t\\), we have \\(\\Delta y\\le\\frac12\\).  \nIf \\(\\Delta x<\\delta\\) then \\(\\Delta x^{2}<r^{2}-\\frac14\\); together with \\(\\Delta y^{2}\\le\\frac14\\) we would obtain  \n\n\\[\nd(P_i,P_j)^{2}=\\Delta x^{2}+\\Delta y^{2}<r^{2},\n\\]\n\ncontradicting the assumption.  Hence \\(\\Delta x\\ge\\delta\\); the same argument gives \\(\\Delta y\\ge\\delta\\). \u220e\n\n---\n\n#### 3.1  Treating the \\(x\\)\u2011coordinates  \n\nAfter the reduction to \\([0,1)^2\\) we have numbers \\(x_1,\\dots,x_4\\in[0,1)\\).  \nSort them  \n\n\\[\nu_1<u_2<u_3<u_4 \\qquad(\\text{distinctness follows from Lemma\u202f1 because }\\delta>0).\n\\]\n\nDefine the four *cyclic gaps*  \n\n\\[\na=u_2-u_1,\\; b=u_3-u_2,\\; c=u_4-u_3,\\; d=1-(u_4-u_1).\n\\]\n\nThese numbers are non\u2011negative, satisfy  \n\n\\[\na+b+c+d=1,\n\\]\n\nand represent the lengths of the arcs between consecutive points on the circle \\(\\mathbb R/\\mathbb Z\\).\n\n---\n\n#### 3.2  Consequences of Lemma\u202f1 for the gaps  \n\nFor the pairs that are neighbours in this order we have  \n\n\\[\n\\|u_2-u_1\\|=\\min(a,1-a),\\;\\|u_3-u_2\\|=\\min(b,1-b),\\;\n\\|u_4-u_3\\|=\\min(c,1-c),\\;\\|u_4-u_1\\|=\\min(1-d,d)=\\min(d,1-d).\n\\]\n\nApplying Lemma\u202f1 to each of these four pairs gives  \n\n\\[\n\\min(a,1-a)\\ge\\delta,\\;\\min(b,1-b)\\ge\\delta,\\;\n\\min(c,1-c)\\ge\\delta,\\;\\min(d,1-d)\\ge\\delta .\n\\]\n\nBecause a number is always at least its own minimum, we obtain  \n\n\\[\na\\ge\\delta,\\; b\\ge\\delta,\\; c\\ge\\delta,\\; d\\ge\\delta .\\tag{1}\n\\]\n\n(We also get \\(a\\le1-\\delta\\) etc., but only the lower bounds are needed later.)\n\n---\n\n#### 3.3  Sum of squared \\(x\\)-distances  \n\nLet  \n\n\\[\nf(t)=\\bigl(\\min\\{t,1-t\\}\\bigr)^{2}\\qquad(0\\le t\\le1).\n\\]\n\nWith the gaps the six unordered pairs contribute  \n\n\\[\nS_x:= \\sum_{i<j}\\|x_i-x_j\\|^{2}\n     =f(a)+f(b)+f(c)+f(d)+f(a+b)+f(b+c). \\tag{2}\n\\]\n\nWe now bound each term from above.\n\n* For any \\(t\\), \\(\\min(t,1-t)\\le t\\); therefore \\(f(t)\\le t^{2}\\).  \n  Consequently  \n\n  \\[\n  f(a)\\le a^{2},\\; f(b)\\le b^{2},\\; f(c)\\le c^{2},\\; f(d)\\le d^{2}.\n  \\]\n\n* The inequality \\(f(t)\\le t(1-t)\\) holds for all \\(t\\in[0,1]\\) (proof by checking the two cases \\(t\\le\\frac12\\) and \\(t\\ge\\frac12\\)).  \n  Since \\(a+b+c+d=1\\), we have \\(1-(a+b)=c+d\\) and \\(1-(b+c)=a+d\\); hence  \n\n  \\[\n  f(a+b)\\le (a+b)(c+d),\\qquad f(b+c)\\le (b+c)(a+d).\n  \\]\n\nInserting these bounds into (2) yields  \n\n\\[\nS_x\\le a^{2}+b^{2}+c^{2}+d^{2}+(a+b)(c+d)+(b+c)(a+d). \\tag{3}\n\\]\n\n---\n\n#### 3.4  Simplifying the right\u2011hand side  \n\nUsing \\(a+b+c+d=1\\) we can rewrite  \n\n\\[\n\\begin{aligned}\n(a+b)(c+d)&=(a+b)\\bigl(1-(a+b)\\bigr)=(a+b)-(a+b)^{2},\\\\\n(b+c)(a+d)&=(b+c)\\bigl(1-(b+c)\\bigr)=(b+c)-(b+c)^{2}.\n\\end{aligned}\n\\]\n\nTherefore the right\u2011hand side of (3) becomes  \n\n\\[\na^{2}+b^{2}+c^{2}+d^{2}+(a+b)+(b+c)-\\bigl[(a+b)^{2}+(b+c)^{2}\\bigr].\n\\]\n\nA straightforward algebraic expansion (or, more compactly, substituting \\(d=1-a-b-c\\) and simplifying) leads to the elegant identity  \n\n\\[\na^{2}+b^{2}+c^{2}+d^{2}+(a+b)(c+d)+(b+c)(a+d)=1+(a+c)^{2}-(a+c). \\tag{4}\n\\]\n\n*Verification of (4):*  \n\\[\n\\begin{aligned}\n&a^{2}+b^{2}+c^{2}+d^{2}+(a+b)(c+d)+(b+c)(a+d)\\\\\n&=a^{2}+b^{2}+c^{2}+d^{2}+(a+b)+(b+c)-\\bigl[(a+b)^{2}+(b+c)^{2}\\bigr] \\\\\n&=d^{2}-2ab-2bc-b^{2}+a+2b+c\\\\\n&=1+(a+c)^{2}-(a+c) \\quad (\\text{after substituting }d=1-a-b-c\\text{ and expanding}).\n\\end{aligned}\n\\]\n\nSet  \n\n\\[\nX:=a+c .\n\\]\n\nThen (3) and (4) give  \n\n\\[\nS_x\\le 1+X^{2}-X. \\tag{5}\n\\]\n\n---\n\n#### 3.5  Bounding \\(X\\)  \n\nFrom (1) we have \\(a\\ge\\delta,\\;c\\ge\\delta\\), hence  \n\n\\[\nX\\ge 2\\delta . \\tag{6}\n\\]\n\nAlso \\(b\\ge\\delta,\\;d\\ge\\delta\\) imply \\(b+d\\ge2\\delta\\); because \\(a+b+c+d=1\\),\n\n\\[\nX = a+c = 1-(b+d)\\;\\le\\;1-2\\delta . \\tag{7}\n\\]\n\nThus \\(X\\) lies in the interval  \n\n\\[\n2\\delta\\;\\le\\;X\\;\\le\\;1-2\\delta . \\tag{8}\n\\]\n\n(Notice that (1) together with \\(a+b+c+d=1\\) already gives \\(4\\delta\\le1\\), i.e. \\(\\delta\\le\\frac14\\); therefore the interval is non\u2011empty.)\n\n---\n\n#### 3.6  Maximising the bound  \n\nConsider \\(\\phi(X)=1+X^{2}-X = (X-\\frac12)^{2}+\\frac34\\).  \n\\(\\phi\\) is a convex quadratic (coefficient of \\(X^{2}\\) positive).  \nOn the closed interval \\([2\\delta,\\,1-2\\delta]\\) its maximum occurs at an endpoint.  \nBecause the interval is symmetric about \\(\\frac12\\), both endpoints give the same value:\n\n\\[\n\\phi(2\\delta)=\\phi(1-2\\delta)=1+4\\delta^{2}-2\\delta .\n\\]\n\nConsequently, from (5) and (8),\n\n\\[\nS_x\\le 1+4\\delta^{2}-2\\delta . \\tag{9}\n\\]\n\n---\n\n#### 3.7  The \\(y\\)-coordinates  \n\nExactly the same reasoning applied to the \\(y\\)-coordinates yields  \n\n\\[\nS_y:=\\sum_{i<j}\\|y_i-y_j\\|^{2}\\le 1+4\\delta^{2}-2\\delta . \\tag{10}\n\\]\n\n---\n\n#### 3.8  Combining the two coordinates  \n\nThe total sum of the six squared fractional distances is  \n\n\\[\n\\sum_{i<j} d(P_i,P_j)^{2}=S_x+S_y\\le 2\\bigl(1+4\\delta^{2}-2\\delta\\bigr)=2+8\\delta^{2}-4\\delta . \\tag{11}\n\\]\n\nOn the other hand, because every distance is at least \\(r\\),\n\n\\[\n\\sum_{i<j} d(P_i,P_j)^{2}\\ge 6r^{2}=6\\!\\left(\\delta^{2}+\\frac14\\right)=6\\delta^{2}+\\frac32 . \\tag{12}\n\\]\n\n---\n\n#### 3.9  Deriving the restriction on \\(\\delta\\)\n\nFrom (11) and (12),\n\n\\[\n6\\delta^{2}+\\frac32 \\le 2+8\\delta^{2}-4\\delta\n\\;\\Longrightarrow\\; 0\\le 2\\delta^{2}-4\\delta+\\frac12 .\n\\]\n\nDividing by \\(2\\),\n\n\\[\n\\delta^{2}-2\\delta+\\frac14\\ge0\\;\\Longrightarrow\\;(\\delta-1)^{2}\\ge\\frac34\\;\\Longrightarrow\\;|\\,\\delta-1\\,|\\ge\\frac{\\sqrt3}{2}.\n\\]\n\nBecause \\(\\delta\\le\\frac14\\) (from \\(4\\delta\\le1\\)), \\(\\delta-1\\) is negative; hence \\(|\\,\\delta-1\\,|=1-\\delta\\).  Therefore  \n\n\\[\n1-\\delta\\ge\\frac{\\sqrt3}{2}\\;\\Longrightarrow\\;\n\\delta\\le 1-\\frac{\\sqrt3}{2}= \\frac{2-\\sqrt3}{2}. \\tag{13}\n\\]\n\n---\n\n#### 3.10  Translating back to \\(r\\)\n\nRecall that \\(r^{2}=\\delta^{2}+\\frac14\\).  Using (13),\n\n\\[\nr^{2}\\le \\Bigl(\\frac{2-\\sqrt3}{2}\\Bigr)^{2}+\\frac14\n      = \\frac{4-4\\sqrt3+3}{4}+\\frac14\n      = \\frac{8-4\\sqrt3}{4}=2-\\sqrt3 .\n\\]\n\nHence  \n\n\\[\nr\\le\\sqrt{\\,2-\\sqrt3\\,}= \\frac{\\sqrt6-\\sqrt2}{2}=r_{0}.\n\\]\n\n---\n\n#### 3.11  Completing the upper bound  \n\nWe have shown:\n\n* if \\(r\\le\\frac12\\), then automatically \\(r\\le r_{0}\\) (since \\(r_{0}>\\frac12\\));\n* if \\(r>\\frac12\\) and a configuration with mutual distances \\(\\ge r\\) exists, the above proof forces \\(r\\le r_{0}\\).\n\nThus **no** four points can have all pairwise fractional distances larger than \\(r_{0}\\); i.e.  \n\n\\[\nr_{\\max}\\le r_{0}.\n\\]\n\n---\n\n### 4.  Conclusion  \n\nThe construction in Section\u202f2 shows \\(r_{\\max}\\ge r_{0}\\); the rigorous upper bound in Section\u202f3 shows \\(r_{\\max}\\le r_{0}\\).  \nTherefore the largest real \\(r\\) for which such four points exist is  \n\n\\[\n\\boxed{\\displaystyle r_{\\max}= \\frac{\\sqrt6-\\sqrt2}{2}} .\n\\]\n\n---", "average_automatic_rating": 1.0, "human_rating": 21}}
{"question": "Let $p$ be a prime number and $f$ be a bijection from $\\left\\{0,1,\\ldots,p-1\\right\\}$ to itself. Suppose that for integers $a,b \\in \\left\\{0,1,\\ldots,p-1\\right\\}$, $|f(a) - f(b)|\\leqslant 2024$ if $p \\mid a^2 - b$. Prove that there exists infinite many $p$ such that there exists such an $f$ and there also exists infinite many $p$ such that there doesn't exist such an $f$.", "problem_idx": "CMO2024-5", "model_prediction": {"proof": "### 1. Existence of infinitely many primes with a suitable bijection  \n\n#### 1.1 Infinitely many primes \\(p\\equiv 3\\pmod 4\\)\n\nAssume there are only finitely many primes congruent to \\(3\\) modulo \\(4\\); list them as \\(p_1,p_2,\\dots ,p_k\\).  \nConsider  \n\n\\[\nN = 4p_1p_2\\cdots p_k - 1 .\n\\]\n\n\\(N\\) is odd and \\(N\\equiv -1\\equiv 3\\pmod 4\\).  \nFor each \\(p_i\\) we have \\(p_i\\mid N+1\\) because \\(N+1 = 4\\prod p_i\\).  \nIf some \\(p_i\\) divided \\(N\\), then \\(p_i\\) would divide both \\(N\\) and \\(N+1\\); hence \\(p_i\\mid (N+1)-N = 1\\), impossible.  \nThus **no** \\(p_i\\) divides \\(N\\).\n\nLet \\(q\\) be any prime divisor of \\(N\\). \\(q\\) is odd because \\(N\\) is odd.  \nIf every prime divisor of \\(N\\) were \\(\\equiv 1\\pmod 4\\), then \\(N\\) itself would be \\(\\equiv 1\\pmod 4\\) (product of numbers \\(\\equiv 1\\pmod 4\\) is \\(\\equiv 1\\pmod 4\\)). This contradicts \\(N\\equiv 3\\pmod 4\\).  \nTherefore \\(N\\) possesses at least one prime divisor \\(q\\) with \\(q\\equiv 3\\pmod 4\\). Because none of the \\(p_i\\) divide \\(N\\), this \\(q\\) is a new prime congruent to \\(3\\) modulo \\(4\\) \u2013 a contradiction to the assumption that the list contained all such primes.  \nHence there are infinitely many primes \\(p\\equiv 3\\pmod 4\\).\n\n#### 1.2 Construction of \\(f\\) for a prime \\(p\\equiv 3\\pmod 4\\)\n\nFix such a prime \\(p\\) and write \\(\\mathbb Z_p=\\{0,1,\\dots ,p-1\\}\\).  \nDefine the set of quadratic residues  \n\n\\[\nQ = \\{x^{2}\\bmod p\\mid x\\in\\mathbb Z_p\\},\\qquad \nR = Q\\setminus\\{0\\}\\;(\\text{non\u2011zero residues}),\\qquad \nN = \\mathbb Z_p\\setminus Q\\;(\\text{non\u2011residues}).\n\\]\n\nIt is well known that \\(|Q| = \\frac{p+1}{2}\\); consequently \\(|R| = |N| = \\frac{p-1}{2}\\).\n\n---\n\n**Lemma 1.** The map \\(\\varphi : N \\to R,\\ \\varphi(a)=a^{2}\\pmod p\\) is a bijection.\n\n*Proof.* For \\(a\\in N\\), \\(a^{2}\\) is a quadratic residue and non\u2011zero (because \\(p\\nmid a\\)), so \\(\\varphi\\) maps into \\(R\\).  \nSuppose \\(a,b\\in N\\) satisfy \\(a^{2}\\equiv b^{2}\\pmod p\\). Then \\((ab^{-1})^{2}\\equiv 1\\pmod p\\); hence \\(a\\equiv \\pm b\\pmod p\\).  \n\nIf \\(a\\equiv -b\\), then \\(b\\equiv -a\\). Since \\(p\\equiv 3\\pmod 4\\), the Legendre symbol \\(\\bigl(\\frac{-1}{p}\\bigr)=(-1)^{(p-1)/2}=-1\\). Using multiplicativity,\n\\[\n\\Bigl(\\frac{-a}{p}\\Bigr)=\\Bigl(\\frac{-1}{p}\\Bigr)\\Bigl(\\frac{a}{p}\\Bigr)=(-1)\\cdot(-1)=1,\n\\]\nso \\(-a\\) is a quadratic residue. But then \\(b\\equiv -a\\) would be a residue, contradicting \\(b\\in N\\).  \nTherefore we must have \\(a\\equiv b\\), proving injectivity. Because \\(|N|=|R|\\), \\(\\varphi\\) is also surjective. \u220e\n\n---\n\n**Lemma 2.** The squaring map \\(\\psi : R \\to R,\\ \\psi(r)=r^{2}\\pmod p\\) is a permutation of \\(R\\).\n\n*Proof.* The multiplicative group \\((\\mathbb Z/p\\mathbb Z)^{\\times}\\) is cyclic; its subgroup of quadratic residues \\(R\\) is therefore cyclic of order \\(\\frac{p-1}{2}\\).  \nFor \\(p\\equiv 3\\pmod 4\\), \\(\\frac{p-1}{2}\\) is odd. In a cyclic group of odd order the map \\(x\\mapsto x^{2}\\) is an automorphism (the exponent \\(2\\) is coprime to the group order). Hence \\(\\psi\\) is bijective. \u220e\n\n---\n\nDecompose \\(\\psi\\) into disjoint cycles. Denote the cycles by \\(C_1,\\dots ,C_k\\) and let \\(L_i = |C_i|\\); thus  \n\n\\[\n\\sum_{i=1}^{k}L_i = |R| = \\frac{p-1}{2}.\n\\]\n\nSet \\(S_0 = 0\\) and for \\(i\\ge 1\\) define \\(S_i = L_1 + \\cdots + L_i\\).\n\nFor each cycle we will use the even numbers  \n\n\\[\nE_i = \\{\\,2S_{i-1},\\;2S_{i-1}+2,\\;\\dots ,\\;2(S_{i-1}+L_i-1)\\,\\}.\n\\]\n\nThe sets \\(E_i\\) are pairwise disjoint, their union is \\(\\{0,2,4,\\dots ,p-3\\}\\) (all even numbers except \\(p-1\\)), and \\(|E_i| = L_i\\).\n\nNow fix a cycle \\(C_i\\) and choose a starting element \\(r_0\\in C_i\\). Define recursively  \n\n\\[\nr_{j+1} = r_j^{\\,2}\\pmod p\\qquad(j=0,1,\\dots ,L_i-2);\n\\]\n\nbecause \\(\\psi\\) is a permutation we have \\(r_{L_i-1}^{\\,2}=r_0\\). Thus \\((r_0,r_1,\\dots ,r_{L_i-1})\\) lists the elements of the cycle in the order they are visited by repeated squaring.\n\nWe assign an auxiliary integer \\(g(r_j)\\in\\{0,1,\\dots ,L_i-1\\}\\) as follows.\n\n* **Even length** \\(L_i = 2k\\):  \n\n  \\[\n  \\begin{aligned}\n  g(r_j) &= 2j &&(j=0,1,\\dots ,k-1),\\\\[2mm]\n  g(r_{k+j}) &= L_i-1-2j &&(j=0,1,\\dots ,k-1).\n  \\end{aligned}\n  \\]\n\n* **Odd length** \\(L_i = 2k+1\\):  \n\n  \\[\n  \\begin{aligned}\n  g(r_j) &= 2j &&(j=0,1,\\dots ,k),\\\\[2mm]\n  g(r_{k+1+j}) &= L_i-2-2j &&(j=0,1,\\dots ,k-1).\n  \\end{aligned}\n  \\]\n\nFor a cycle of length \\(1\\) (i.e. \\(k=0\\) in the odd case) this simply gives \\(g(r_0)=0\\).\n\nA direct inspection shows that in each case the values \\(g(r_j)\\) are exactly the integers \\(0,1,\\dots ,L_i-1\\) (hence \\(g\\) is a bijection from the cycle onto that set) and that for every \\(j\\) (indices taken modulo \\(L_i\\))\n\n\\[\n|g(r_j)-g(r_{j+1})|\\le 2. \\tag{1}\n\\]\n\n(For even length the only differences of \\(1\\) occur between \\(r_{k-1}\\) and \\(r_k\\) and between \\(r_{2k-1}\\) and \\(r_0\\); all other consecutive indices differ by \\(2\\). For odd length the only differences of \\(1\\) occur between \\(r_k\\) and \\(r_{k+1}\\) and between \\(r_{2k}\\) and \\(r_0\\); again all other steps differ by \\(2\\).)\n\nNow define for every \\(r\\in R\\)\n\n\\[\nf(r) = 2\\bigl(S_{i-1}+g(r)\\bigr)\\qquad\\text{if } r\\in C_i.\n\\]\n\nBecause \\(g(r)\\) runs through \\(\\{0,\\dots ,L_i-1\\}\\) as \\(r\\) runs through \\(C_i\\), the values \\(f(r)\\) for \\(r\\in C_i\\) are exactly the even numbers in \\(E_i\\). Consequently \\(f\\) maps \\(R\\) bijectively onto the set \\(\\{0,2,4,\\dots ,p-3\\}\\).\n\nIf \\(r\\in R\\) and \\(s = r^{2}\\) (the successor of \\(r\\) in its cycle), then by (1)\n\n\\[\n|f(r)-f(s)| = 2\\,|g(r)-g(s)| \\le 2\\cdot 2 = 4 \\le 2024. \\tag{2}\n\\]\n\n---\n\n**The element \\(0\\).** Set  \n\n\\[\nf(0) = p-1.\n\\]\n\n**Non\u2011residues.** For \\(a\\in N\\) define  \n\n\\[\nf(a) = f(a^{2}) + 1,\n\\]\n\nwhere \\(a^{2}\\) denotes the element of \\(R\\) obtained by squaring modulo \\(p\\) (Lemma\u202f1 guarantees \\(a^{2}\\in R\\)). Because \\(f(a^{2})\\) is even, \\(f(a)\\) is odd.\n\n---\n\n**Bijectivity.**  \n- \\(f|_{R}\\) is a bijection onto the evens \\(\\{0,2,\\dots ,p-3\\}\\).  \n- Lemma\u202f1 gives a bijection \\(\\varphi : N\\to R\\). Composing with \\(f|_{R}\\) and adding \\(1\\) yields a bijection from \\(N\\) onto the odds \\(\\{1,3,\\dots ,p-2\\}\\).  \n- Finally \\(f(0)=p-1\\) is the unique even number \\(p-1\\) not used for \\(R\\).  \n\nThe three images \\(\\{p-1\\},\\{0,2,\\dots ,p-3\\},\\{1,3,\\dots ,p-2\\}\\) partition \\(\\{0,1,\\dots ,p-1\\}\\); therefore \\(f\\) is a permutation of this set.\n\n---\n\n**Verification of the required bound.**  \nLet \\(a,b\\in\\mathbb Z_p\\) satisfy \\(p\\mid a^{2}-b\\). Because \\(b\\) is the unique element of \\(\\mathbb Z_p\\) congruent to \\(a^{2}\\) modulo \\(p\\), we have \\(b\\equiv a^{2}\\pmod p\\) and we distinguish three cases.\n\n* \\(a=0\\): then \\(b=0\\) and \\(|f(0)-f(0)|=0\\le2024\\).  \n* \\(a\\in R\\): then \\(b=a^{2}\\in R\\) and (2) gives \\(|f(a)-f(b)|\\le4\\le2024\\).  \n* \\(a\\in N\\): then \\(b=a^{2}\\in R\\) and \\(|f(a)-f(b)| = |(f(a^{2})+1)-f(a^{2})| = 1\\le2024\\).\n\nThus for every prime \\(p\\equiv 3\\pmod 4\\) we have constructed a bijection \\(f\\) satisfying the condition. Together with the infinitude of such primes proved in \u00a71.1 we conclude:\n\n\\[\n\\text{There are infinitely many primes }p\\text{ for which a suitable bijection }f\\text{ exists.}\n\\]\n\n---\n\n### 2. Non\u2011existence for infinitely many primes  \n\n#### 2.1 A necessary condition  \n\nLet \\(p\\) be an odd prime and write  \n\n\\[\np-1 = 2^{s}\\,m\\qquad(s\\ge 1,\\;m\\text{ odd}).\n\\]\n\nThe multiplicative group \\((\\mathbb Z/p\\mathbb Z)^{\\times}\\) is cyclic of order \\(p-1\\). Consequently it contains a unique subgroup of order \\(2^{s}\\); call it \\(H\\). \\(H\\) is cyclic, and the set  \n\n\\[\nA = \\{\\,x\\in (\\mathbb Z/p\\mathbb Z)^{\\times}\\mid \\operatorname{ord}(x)=2^{s}\\,\\}\n\\]\n\nis exactly the set of generators of \\(H\\). Hence  \n\n\\[\n|A| = \\varphi(2^{s}) = 2^{s-1}.\n\\]\n\nAssume that a bijection \\(f:\\mathbb Z_p\\to\\{0,1,\\dots ,p-1\\}\\) satisfies  \n\n\\[\np\\mid a^{2}-b\\;\\Longrightarrow\\;|f(a)-f(b)|\\le 2024. \\tag{\u2217}\n\\]\n\nTake any \\(a\\in A\\) and consider the chain obtained by repeated squaring:\n\n\\[\na_0 = a,\\quad a_1 = a^{2}\\pmod p,\\quad a_2 = a_1^{2}\\pmod p = a^{4}\\pmod p,\\;\\dots\\;,\\;a_s = a^{2^{s}}\\equiv 1\\pmod p.\n\\]\n\n(All \\(a_i\\) are taken as the representatives in \\(\\{0,\\dots ,p-1\\}\\).)  \n\nFor each \\(i=0,\\dots ,s-1\\) we have \\(a_{i+1}\\equiv a_i^{2}\\pmod p\\); therefore (\u2217) yields  \n\n\\[\n|f(a_i)-f(a_{i+1})|\\le 2024.\n\\]\n\nApplying the triangle inequality repeatedly gives  \n\n\\[\n|f(a)-f(1)| = |f(a_0)-f(a_s)|\n            \\le \\sum_{i=0}^{s-1}|f(a_i)-f(a_{i+1})|\n            \\le s\\cdot 2024. \\tag{3}\n\\]\n\nDefine  \n\n\\[\nJ = \\{\\,x\\in\\{0,1,\\dots ,p-1\\}\\mid |x-f(1)|\\le s\\cdot2024\\,\\}.\n\\]\n\nFrom (3) we have \\(f(a)\\in J\\) for every \\(a\\in A\\). Because \\(f\\) is injective, the values \\(f(a)\\;(a\\in A)\\) are pairwise distinct; hence  \n\n\\[\n|J|\\ \\ge\\ |A| = 2^{s-1}. \\tag{4}\n\\]\n\nOn the other hand, \\(J\\) is a subset of the real interval \\(I = [f(1)-s\\cdot2024,\\ f(1)+s\\cdot2024]\\). An interval of length \\(L = 2s\\cdot2024\\) can contain at most \\(L+1 = 2s\\cdot2024+1\\) integers. Thus  \n\n\\[\n|J|\\ \\le\\ 2s\\cdot2024+1. \\tag{5}\n\\]\n\nCombining (4) and (5) we obtain the **necessary condition**\n\n\\[\n2^{s-1}\\ \\le\\ 2s\\cdot2024+1. \\tag{6}\n\\]\n\n#### 2.2 When does (6) fail?  \n\nCompute for \\(s=18\\):\n\n\\[\n2^{s-1}=2^{17}=131072,\\qquad 2s\\cdot2024+1 = 2\\cdot18\\cdot2024+1 = 72865.\n\\]\n\nThus \\(2^{17} > 72865\\); inequality (6) is false for \\(s=18\\).\n\nWe show that once (6) fails for some \\(s\\ge 3\\), it also fails for \\(s+1\\).  \nAssume \\(2^{s-1} > 2s\\cdot2024+1\\). Multiplying by \\(2\\) gives  \n\n\\[\n2^{s} > 4s\\cdot2024+2.\n\\]\n\nCompare the right\u2011hand side with the bound needed for \\(s+1\\):\n\n\\[\n4s\\cdot2024+2 - \\bigl(2(s+1)\\cdot2024+1\\bigr) = 2s\\cdot2024 - 4047.\n\\]\n\nFor \\(s\\ge 3\\), \\(2s\\cdot2024 \\ge 2\\cdot3\\cdot2024 = 12144\\), so the difference is positive. Hence  \n\n\\[\n4s\\cdot2024+2 > 2(s+1)\\cdot2024+1,\n\\]\n\nand together with \\(2^{s} > 4s\\cdot2024+2\\) we obtain  \n\n\\[\n2^{s} > 2(s+1)\\cdot2024+1,\n\\]\n\ni.e. \\(2^{(s+1)-1} > 2(s+1)\\cdot2024+1\\). So the failure propagates to \\(s+1\\).\n\nSince (6) fails for \\(s=18\\), by induction it fails for every integer \\(s\\ge 18\\).  \n\nConsequently **no** bijection satisfying (\u2217) can exist for any prime \\(p\\) with \\(v_{2}(p-1)=s\\ge 18\\) (equivalently, \\(2^{18}\\mid p-1\\)).\n\n#### 2.3 Infinitely many primes with \\(v_{2}(p-1)\\ge 18\\)\n\nWe use the Fermat numbers  \n\n\\[\nF_n = 2^{2^{n}} + 1\\qquad(n\\ge 0).\n\\]\n\n**Coprimality.** The numbers \\(F_n\\) are pairwise coprime.  \nIndeed, one proves by induction that  \n\n\\[\nF_n = \\prod_{i=0}^{n-1}F_i + 2\\qquad(n\\ge 1).\n\\]\n\n(For \\(n=1\\): \\(\\prod_{i=0}^{0}F_i = F_0 = 3\\) and \\(3+2=5 = F_1\\). Assuming the formula for \\(n\\), then  \n\\[\n\\prod_{i=0}^{n}F_i = F_n\\prod_{i=0}^{n-1}F_i = F_n(F_n-2) = F_n^{2}-2F_n,\n\\]\nwhile  \n\\[\nF_{n+1} = (2^{2^{n}})^{2}+1 = (F_n-1)^{2}+1 = F_n^{2}-2F_n+2 = \\prod_{i=0}^{n}F_i + 2,\n\\]\ncompleting the induction.)  \n\nNow if a prime \\(p\\) divided both \\(F_k\\) and \\(F_n\\) with \\(k<n\\), then \\(p\\) would divide the product \\(\\prod_{i=0}^{n-1}F_i = F_n-2\\); consequently \\(p\\mid F_n-(F_n-2)=2\\), forcing \\(p=2\\). All Fermat numbers are odd, so this is impossible. Hence \\(\\gcd(F_k,F_n)=1\\) for \\(k\\neq n\\).\n\n**Prime divisors of \\(F_n\\) have large 2\u2011adic valuation.**  \nTake any \\(n\\ge 17\\). Since \\(F_n>1\\) and is odd, it possesses at least one odd prime divisor \\(p\\). From \\(F_n\\equiv 0\\pmod p\\) we obtain  \n\n\\[\n2^{2^{n}}\\equiv -1\\pmod p.\n\\]\n\nSquaring gives \\(2^{2^{n+1}}\\equiv 1\\pmod p\\). Thus the order \\(\\operatorname{ord}_p(2)\\) divides \\(2^{n+1}\\). It cannot divide \\(2^{n}\\); otherwise we would have \\(2^{2^{n}}\\equiv 1\\pmod p\\), contradicting the congruence above. Hence \\(\\operatorname{ord}_p(2)=2^{n+1}\\).  \n\nBy Fermat\u2019s little theorem, \\(\\operatorname{ord}_p(2)\\mid p-1\\); therefore \\(2^{n+1}\\mid(p-1)\\). In particular  \n\n\\[\nv_{2}(p-1)\\ \\ge\\ n+1\\ \\ge\\ 18.\n\\]\n\n**Infiniteness.** Because the Fermat numbers are pairwise coprime, the prime divisors of distinct \\(F_n\\) are distinct. For each \\(n\\ge 17\\) pick one prime divisor \\(p_n\\) of \\(F_n\\). Then \\(\\{p_n\\mid n\\ge 17\\}\\) is an infinite set of distinct primes, each satisfying \\(v_{2}(p_n-1)\\ge 18\\).  \n\nThus there are infinitely many primes for which the necessary condition (6) is violated, and consequently no bijection \\(f\\) with the required property can exist for those primes.\n\n---\n\n### 3. Conclusion  \n\nWe have proved:  \n\n* There are infinitely many primes (all primes congruent to \\(3\\) modulo \\(4\\)) for which a bijection \\(f\\) satisfying \\(|f(a)-f(b)|\\le 2024\\) whenever \\(p\\mid a^{2}-b\\) exists.  \n* There are infinitely many primes (e.g. the prime divisors of the Fermat numbers \\(F_n\\) with \\(n\\ge 17\\)) for which such a bijection cannot exist.  \n\nHence the statement of the problem holds. \u220e", "average_automatic_rating": 1.0, "human_rating": 21}}
{"question": "Let $a_1, a_2, \\ldots, a_n$ be real numbers such that $\\sum_{i=1}^n a_i = n$, $\\sum_{i = 1}^n a_i^2 = 2n$, $\\sum_{i=1}^n a_i^3 = 3n$.\n(i) Find the largest constant $C$, such that for all $n \\geqslant 4$,\\[ \\max \\left\\{ a_1, a_2, \\ldots, a_n \\right\\} - \\min \\left\\{ a_1, a_2, \\ldots, a_n \\right\\} \\geqslant C. \\](ii) Prove that there exists a positive constant $C_2$, such that\\[ \\max \\left\\{ a_1, a_2, \\ldots, a_n \\right\\} - \\min \\left\\{ a_1, a_2, \\ldots, a_n \\right\\} \\geqslant C + C_2 n^{-\\frac 32}, \\]where $C$ is the constant determined in (i).", "problem_idx": "CMO2024-6", "model_prediction": {"proof": "### Part\u202f(i)  \n\nPut  \n\n\\[\nd_i=a_i-1\\qquad(i=1,\\dots ,n).\n\\]\n\nThen  \n\n\\[\n\\sum_{i=1}^{n}d_i =0,\\qquad \n\\sum_{i=1}^{n}d_i^{2}=n,\\qquad \n\\sum_{i=1}^{n}d_i^{3}=-n. \\tag{0}\n\\]\n\nDefine  \n\n\\[\nu=\\max_i d_i,\\qquad v=-\\min_i d_i\\;(>0),\\qquad \nD=u+v=\\max_i a_i-\\min_i a_i .\n\\]\n\nAll \\(d_i\\) lie in \\([-v,u]\\); hence for every \\(i\\)\n\n\\[\nd_i+v\\ge 0,\\qquad u-d_i\\ge 0 .\n\\]\n\n---\n**Three non\u2011negative sums**  \n\n\\[\n\\begin{aligned}\nS_1&:=\\sum_{i=1}^{n}(d_i+v)^{2}(u-d_i)\\ge 0,\\\\[2mm]\nS_2&:=\\sum_{i=1}^{n}(d_i+v)(u-d_i)^{2}\\ge 0,\\\\[2mm]\nT&:=\\sum_{i=1}^{n}(d_i+v)(u-d_i)\\ge 0 .\n\\end{aligned}\n\\]\n\nExpanding each sum and using (0) gives  \n\n\\[\n\\begin{aligned}\nS_1&=\\sum_i\\bigl(d_i^{2}+2v d_i+v^{2}\\bigr)(u-d_i)\\\\\n   &=u\\sum d_i^{2}+2vu\\sum d_i+u v^{2}n-\\sum d_i^{3}-2v\\sum d_i^{2}-v^{2}\\sum d_i\\\\\n   &=un+0+u v^{2}n-(-n)-2vn-0\\\\\n   &=n\\bigl(uv^{2}+u+1-2v\\bigr),\\\\[2mm]\nS_2&=\\sum_i(d_i+v)(u^{2}-2u d_i+d_i^{2})\\\\\n   &=u^{2}\\sum d_i-2u\\sum d_i^{2}+\\sum d_i^{3}+v u^{2}n-2uv\\sum d_i+v\\sum d_i^{2}\\\\\n   &=0-2un+(-n)+v u^{2}n-0+vn\\\\\n   &=n\\bigl(v u^{2}+v-2u-1\\bigr),\\\\[2mm]\nT&=\\sum_i\\bigl((d_i+v)u-(d_i+v)d_i\\bigr)\n   =u\\sum(d_i+v)-\\sum(d_i^{2}+v d_i)\\\\\n   &=u\\bigl(\\sum d_i+n v\\bigr)-\\bigl(\\sum d_i^{2}+v\\sum d_i\\bigr)\n   =u(0+n v)-(n+0)=n(uv-1).\n\\end{aligned}\n\\]\n\nBecause the three sums are non\u2011negative we obtain  \n\n\\[\n\\boxed{uv^{2}+u+1\\ge 2v}\\tag{1}\n\\]  \n\n\\[\n\\boxed{v u^{2}+v\\ge 2u+1}\\tag{2}\n\\]  \n\n\\[\n\\boxed{uv\\ge 1}\\tag{3}\n\\]\n\n---\n**Consequences for \\(u,v\\)**  \n\nFrom (2)  \n\n\\[\nv\\ge\\frac{2u+1}{u^{2}+1}=:f(u). \\tag{4}\n\\]\n\nFrom (3)  \n\n\\[\nv\\ge\\frac{1}{u}. \\tag{5}\n\\]\n\nThus  \n\n\\[\nv\\ge\\max\\!\\Bigl(f(u),\\frac1u\\Bigr)\\quad\\Longrightarrow\\quad \nD=u+v\\ge u+\\max\\!\\Bigl(f(u),\\frac1u\\Bigr)=:\\varphi(u). \\tag{6}\n\\]\n\n---\n**Minimising \\(\\varphi(u)\\)**  \n\nThe equation \\(f(u)=1/u\\) is  \n\n\\[\n\\frac{2u+1}{u^{2}+1}=\\frac1u\\;\\Longleftrightarrow\\;u^{2}+u-1=0,\n\\]\n\nwhose positive root is  \n\n\\[\nu_{0}=\\frac{\\sqrt5-1}{2}\\approx0.618,\\qquad \nv_{0}=u_{0}+1=\\frac{\\sqrt5+1}{2}\\approx1.618 .\n\\]\n\n*For \\(0<u\\le u_{0}\\)* we have \\(1/u\\ge f(u)\\); therefore  \n\n\\[\n\\varphi(u)=u+\\frac1u .\n\\]\n\nOn \\((0,u_{0}]\\) the derivative \\(1-1/u^{2}\\le0\\); hence \\(\\varphi\\) is decreasing and attains its minimum at the right end \\(u=u_{0}\\):\n\n\\[\n\\varphi(u)\\ge \\varphi(u_{0})=u_{0}+\\frac1{u_{0}}=\\sqrt5 .\n\\]\n\n*For \\(u\\ge u_{0}\\)* we have \\(f(u)\\ge 1/u\\); therefore  \n\n\\[\n\\varphi(u)=u+f(u).\n\\]\n\nA direct computation gives  \n\n\\[\nf'(u)=-\\frac{2(u^{2}+u-1)}{(u^{2}+1)^{2}},\\qquad \n\\varphi'(u)=1+f'(u)=1-\\frac{2(u^{2}+u-1)}{(u^{2}+1)^{2}} .\n\\]\n\nFor \\(u\\ge u_{0}\\) we have \\(u^{2}+u-1\\ge0\\); moreover  \n\n\\[\n(u^{2}+1)^{2}>2(u^{2}+u-1)\\qquad(\\text{because }u^{4}-2u+3>0\\;\\forall u\\ge0),\n\\]\n\nso \\(\\varphi'(u)>0\\). Hence \\(\\varphi\\) is strictly increasing on \\([u_{0},\\infty)\\) and  \n\n\\[\n\\varphi(u)\\ge\\varphi(u_{0})=\\sqrt5 .\n\\]\n\nIn **both** cases we have proved  \n\n\\[\n\\boxed{\\;D\\ge\\sqrt5\\;}. \\tag{7}\n\\]\n\n---\n**Sharpness \u2013 the constant cannot be larger**  \n\nLet  \n\n\\[\nu_{0}=\\frac{\\sqrt5-1}{2},\\;v_{0}=u_{0}+1,\\;D_{0}=u_{0}+v_{0}=\\sqrt5 .\n\\]\n\nFor any \\(\\varepsilon>0\\) choose a **rational** number \\(u\\) with  \n\n\\[\nu>u_{0},\\qquad |u-u_{0}|<\\frac{\\varepsilon}{4}.\n\\]\n\nSet \\(v=u+1\\) and \\(D=u+v=2u+1\\); then \\(|D-\\sqrt5|=2|u-u_{0}|<\\varepsilon/2\\).\n\nBecause \\(u\\) is rational, the numbers  \n\n\\[\n\\alpha=\\frac{1}{uD},\\qquad \\beta=\\frac{1}{vD}\n\\]\n\nare rational. Write \\(\\alpha=\\frac{a_{1}}{b_{1}},\\;\\beta=\\frac{a_{2}}{b_{2}}\\) in lowest terms and let \\(L=\\operatorname{lcm}(b_{1},b_{2})\\). Choose an integer \\(N\\) that is a multiple of \\(L\\) and satisfies \\(N\\ge4\\) (e.g. \\(N=L\\) if \\(L\\ge4\\), otherwise \\(N=4L\\)).  \nNow set  \n\n\\[\nn:=N,\\qquad r:=N\\alpha,\\; s:=N\\beta,\\; t:=N-r-s .\n\\]\n\nSince \\(u>u_{0}\\) implies \\(uv>1\\) and therefore \\(\\alpha+\\beta=1/(uv)<1\\), we have \\(t>0\\).  \nAll three numbers \\(r,s,t\\) are non\u2011negative integers and \\(r+s+t=n\\).\n\nConstruct the \\(a_i\\) as follows:  \n\n* \\(r\\) copies of \\(1+u\\) (i.e. \\(d_i=u\\)),  \n* \\(s\\) copies of \\(1-v\\) (i.e. \\(d_i=-v\\)),  \n* \\(t\\) copies of \\(1\\) (i.e. \\(d_i=0\\)).\n\nThen  \n\n\\[\n\\begin{aligned}\n\\sum a_i &= r(1+u)+s(1-v)+t\\cdot1 = n + (ru-sv) = n,\\\\[2mm]\n\\sum a_i^{2} &= r(1+u)^{2}+s(1-v)^{2}+t\\cdot1^{2} \n            = n + 2(ru-sv) + (ru^{2}+sv^{2}) = n+0+n = 2n,\\\\[2mm]\n\\sum a_i^{3} &= r(1+u)^{3}+s(1-v)^{3}+t\\cdot1^{3} \\\\\n            &= n + 3(ru-sv) + 3(ru^{2}+sv^{2}) + (ru^{3}-sv^{3}) \n            = n+0+3n+(-n)=3n .\n\\end{aligned}\n\\]\n\n(The identities \\(ru=sv=n/D\\) and \\(v=u+1\\) guarantee the third\u2011moment condition.)  \n\nThe range of this set is  \n\n\\[\n\\max a_i-\\min a_i = (1+u)-(1-v)=u+v = D < \\sqrt5+\\varepsilon .\n\\]\n\nSince \\(\\varepsilon>0\\) was arbitrary, no constant larger than \\(\\sqrt5\\) can work for **all** admissible sequences. Together with (7) we obtain  \n\n\\[\n\\boxed{C=\\sqrt5}.\n\\]\n\n---\n\n### Part\u202f(ii)  \n\nFix an integer \\(n\\ge4\\) and consider  \n\n\\[\n\\mathcal{F}_n=\\{(a_1,\\dots ,a_n)\\in\\mathbb R^{n}\\mid \n\\sum a_i=n,\\;\\sum a_i^{2}=2n,\\;\\sum a_i^{3}=3n\\}.\n\\]\n\nBecause \\(\\sum a_i^{2}=2n\\) implies \\(|a_i|\\le\\sqrt{2n}\\), \\(\\mathcal{F}_n\\) is a closed bounded subset of \\(\\mathbb R^{n}\\) and therefore **compact**.  \nThe function  \n\n\\[\nR(a)=\\max_i a_i-\\min_i a_i\n\\]\n\nis continuous; hence it attains its minimum on \\(\\mathcal{F}_n\\).  \nLet \\(a\\) be a minimiser and denote  \n\n\\[\nM=\\max_i a_i,\\qquad m=\\min_i a_i,\\qquad D=M-m .\n\\]\n\n---\n#### 1.  Basic properties  \n\n* **Location of\u202f1.**  \n  If all \\(a_i\\ge 1\\) then \\(a_i-1\\ge0\\) and \\(\\sum (a_i-1)=0\\) forces \\(a_i=1\\) for every \\(i\\), contradicting \\(\\sum a_i^{2}=2n\\).  \n  The same argument shows that not all \\(a_i\\le 1\\). Consequently there exist indices with \\(a_i>1\\) and with \\(a_i<1\\); therefore  \n\n  \\[\n  m<1<M .\n  \\]\n\n  Define \\(u=M-1>0,\\;v=1-m>0\\).\n\n* **Two\u2011value configurations are impossible.**  \n  Assume, for contradiction, that a feasible vector consists only of the two values \\(M\\) and \\(m\\).  \n  Let \\(r=\\#\\{i:a_i=M\\},\\;s=\\#\\{i:a_i=m\\}\\) (\\(r,s\\ge1,\\;r+s=n\\)).  \n  Translating the moment conditions with \\(u,v\\) gives  \n\n  \\[\n  \\begin{aligned}\n  r u - s v &=0,\\\\\n  r u^{2}+ s v^{2} &= n,\\\\\n  r u^{3}- s v^{3} &= -n. \\tag{\u2020}\n  \\end{aligned}\n  \\]\n\n  From the first two relations we obtain \\(r u = s v =:K\\) and \\(K(u+v)=n\\), i.e. \\(K=n/D\\).  \n  Substituting \\(r=K/u,\\;s=K/v\\) into \\(r+s=n\\) yields  \n\n  \\[\n  \\frac{K}{u}+\\frac{K}{v}=n\\;\\Longrightarrow\\; \\frac{n}{D}\\Bigl(\\frac1u+\\frac1v\\Bigr)=n\n  \\;\\Longrightarrow\\; \\frac{1}{u}+\\frac1v = D\n  \\;\\Longrightarrow\\; \\frac{u+v}{uv}=D\n  \\;\\Longrightarrow\\; \\frac{D}{uv}=D\\;\\Longrightarrow\\; uv=1 .\n  \\]\n\n  Using the third relation of (\u2020) we get  \n\n  \\[\n  K(u^{2}-v^{2})=-n\\;\\Longrightarrow\\;\\frac{n}{D}(u^{2}-v^{2})=-n\n  \\;\\Longrightarrow\\;u^{2}-v^{2}=-D .\n  \\]\n\n  Because \\(D=u+v\\), this simplifies to \\(u-v=-1\\), i.e. \\(v=u+1\\).  \n  Together with \\(uv=1\\) we obtain \\(u^{2}+u-1=0\\) and  \n\n  \\[\n  u=u_{0}=\\frac{\\sqrt5-1}{2},\\qquad v=v_{0}=u_{0}+1=\\frac{\\sqrt5+1}{2},\\qquad D=\\sqrt5 .\n  \\]\n\n  Finally \\(r=K/u=n/(uD)=n/(u_{0}\\sqrt5)\\), which is **irrational** for any integer \\(n\\) \u2013 contradicting that \\(r\\) must be an integer.  \n  Hence **no feasible vector can consist of only two values**.  \n  Consequently every feasible vector (and in particular our minimiser) contains at least three distinct numbers, and therefore there exists an index with  \n\n  \\[\n  m<a_i<M . \\tag{\u2217}\n  \\]\n\n---\n#### 2.  Reformulation as a smooth constrained problem  \n\nTo apply optimality conditions we introduce two auxiliary variables \\(M,m\\) and consider  \n\n\\[\n\\begin{aligned}\n\\text{minimize}\\quad & f(a,M,m)=M-m\\\\\n\\text{subject to}\\quad & g_1(a)=\\sum a_i-n=0,\\\\\n& g_2(a)=\\sum a_i^{2}-2n=0,\\\\\n& g_3(a)=\\sum a_i^{3}-3n=0,\\\\\n& h_i(a,M,m)=a_i-M\\le0\\;\\;(i=1,\\dots,n),\\\\\n& k_i(a,M,m)=m-a_i\\le0\\;\\;(i=1,\\dots,n).\n\\end{aligned}\n\\]\n\nFor our minimiser \\(a\\) we set \\(M=\\max_i a_i,\\;m=\\min_i a_i\\); then \\((a,M,m)\\) is feasible for this extended problem.  \nIf \\((a',M',m')\\) is any feasible point of the extended problem, we have \\(M'\\ge\\max_i a'_i\\) and \\(m'\\le\\min_i a'_i\\), hence  \n\n\\[\nf(a',M',m') = M'-m' \\ge \\max_i a'_i - \\min_i a'_i = R(a').\n\\]\n\nBecause \\(a\\) minimises \\(R\\) over \\(\\mathcal{F}_n\\), the point \\((a,M,m)\\) is a global (hence local) minimiser of the extended problem.\n\n---\n#### 3.  Fritz\u2011John necessary conditions  \n\nAll functions are \\(C^1\\). The Fritz\u2011John theorem (which requires no constraint qualification) guarantees the existence of multipliers  \n\n\\[\n\\lambda_0\\ge0,\\;\\lambda_1,\\lambda_2,\\lambda_3\\in\\mathbb R,\\;\n\\alpha_i\\ge0,\\;\\beta_i\\ge0\\;(i=1,\\dots,n),\n\\]\n\nnot all zero, such that  \n\n\\[\n\\begin{aligned}\n&\\lambda_0\\nabla f + \\lambda_1\\nabla g_1 + \\lambda_2\\nabla g_2 + \\lambda_3\\nabla g_3\n      + \\sum_{i=1}^n \\alpha_i\\nabla h_i + \\sum_{i=1}^n \\beta_i\\nabla k_i = 0,\\\\[2mm]\n&\\alpha_i(a_i-M)=0,\\qquad \\beta_i(m-a_i)=0\\quad (\\text{complementary slackness}).\n\\end{aligned}\n\\]\n\nComputing the gradients yields the component equations  \n\n\\[\n\\begin{aligned}\n&\\frac{\\partial}{\\partial a_i}:\\;\\; \\lambda_1 + 2\\lambda_2 a_i + 3\\lambda_3 a_i^2 + \\alpha_i - \\beta_i = 0\\qquad(i=1,\\dots,n), \\tag{F1}\\\\[2mm]\n&\\frac{\\partial}{\\partial M}:\\;\\; \\lambda_0 - \\sum_{i=1}^n \\alpha_i = 0 \\;\\Longrightarrow\\; \\sum_{i=1}^n \\alpha_i = \\lambda_0, \\tag{F2}\\\\[2mm]\n&\\frac{\\partial}{\\partial m}:\\;\\; -\\lambda_0 + \\sum_{i=1}^n \\beta_i = 0 \\;\\Longrightarrow\\; \\sum_{i=1}^n \\beta_i = \\lambda_0. \\tag{F3}\n\\end{aligned}\n\\]\n\n---\n#### 4.  The multiplier of the objective is positive  \n\nAssume \\(\\lambda_0=0\\). Then (F2)\u2013(F3) give \\(\\sum\\alpha_i=\\sum\\beta_i=0\\), whence \\(\\alpha_i=\\beta_i=0\\) for all \\(i\\) (non\u2011negativity). Equation (F1) reduces to  \n\n\\[\n\\lambda_1 + 2\\lambda_2 a_i + 3\\lambda_3 a_i^2 = 0\\qquad\\forall i.\n\\]\n\nBecause the minimiser contains at least three distinct values (proved in \u00a71), this quadratic would vanish at three distinct points, forcing \\(\\lambda_1=\\lambda_2=\\lambda_3=0\\). Then all multipliers are zero, contradicting the Fritz\u2011John condition that they are not all zero. Hence \\(\\lambda_0>0\\).\n\nSince \\(\\lambda_0>0\\) we may divide the whole system by \\(\\lambda_0\\) and rename the scaled multipliers. Equivalently, we set \\(\\lambda_0=1\\) without loss of generality. Then  \n\n\\[\n\\sum_{i=1}^n \\alpha_i = \\sum_{i=1}^n \\beta_i = 1, \\tag{2}\n\\]\n\nand (F1) becomes  \n\n\\[\n\\lambda + 2\\mu a_i + 3\\nu a_i^2 + \\alpha_i - \\beta_i = 0\\qquad(i=1,\\dots,n), \\tag{4}\n\\]\n\nwhere \\(\\lambda=\\lambda_1/\\lambda_0,\\;\\mu=\\lambda_2/\\lambda_0,\\;\\nu=\\lambda_3/\\lambda_0\\).\n\nDefine \\(Q(x)=\\lambda + 2\\mu x + 3\\nu x^2\\). Then (4) reads  \n\n\\[\nQ(a_i) = -\\alpha_i + \\beta_i. \\tag{5}\n\\]\n\n---\n#### 5.  Consequences of complementary slackness  \n\nLet \\(A=\\{i:a_i=M\\},\\;B=\\{i:a_i=m\\}\\) and set \\(r=|A|,\\;s=|B|\\) (both \\(\\ge1\\)).  \nComplementary slackness gives \\(\\alpha_i=0\\) for \\(i\\notin A\\) and \\(\\beta_i=0\\) for \\(i\\notin B\\). Moreover, for \\(i\\in A\\) we have \\(\\beta_i=0\\), so (5) yields \\(Q(M)=-\\alpha_i\\le0\\); summing over \\(A\\) and using (2) gives  \n\n\\[\nr\\,Q(M)+\\sum_{i\\in A}\\alpha_i =0 \\;\\Longrightarrow\\; r\\,Q(M)+1=0 \\;\\Longrightarrow\\; Q(M)=-\\frac1r<0. \\tag{6}\n\\]\n\nAnalogously, for \\(i\\in B\\) we have \\(\\alpha_i=0\\), \\(Q(m)=\\beta_i\\ge0\\) and  \n\n\\[\ns\\,Q(m)-\\sum_{i\\in B}\\beta_i =0 \\;\\Longrightarrow\\; s\\,Q(m)-1=0 \\;\\Longrightarrow\\; Q(m)=\\frac1s>0. \\tag{7}\n\\]\n\nFor any index with \\(m<a_i<M\\) we have \\(\\alpha_i=\\beta_i=0\\), hence  \n\n\\[\nQ(a_i)=0. \\tag{8}\n\\]\n\n---\n#### 6.  Exploiting the moment conditions  \n\nSumming (5) over all \\(i\\) gives  \n\n\\[\n\\sum_{i=1}^n Q(a_i) = -\\sum\\alpha_i + \\sum\\beta_i = -1+1 =0.\n\\]\n\nBut  \n\n\\[\n\\sum Q(a_i) = \\sum(\\lambda + 2\\mu a_i + 3\\nu a_i^2)\n           = \\lambda n + 2\\mu n + 3\\nu\\cdot2n\n           = n(\\lambda + 2\\mu + 6\\nu),\n\\]\n\nhence  \n\n\\[\n\\lambda + 2\\mu + 6\\nu = 0. \\tag{9}\n\\]\n\nMultiplying (5) by \\(a_i\\) and summing yields  \n\n\\[\n\\sum a_i Q(a_i) = -\\sum a_i\\alpha_i + \\sum a_i\\beta_i.\n\\]\n\nBecause \\(\\alpha_i\\) is non\u2011zero only on \\(A\\) where \\(a_i=M\\) and \\(\\sum\\alpha_i=1\\), we have \\(\\sum a_i\\alpha_i = M\\). Similarly \\(\\sum a_i\\beta_i = m\\). Therefore  \n\n\\[\n\\sum a_i Q(a_i) = -M + m = -D. \\tag{10}\n\\]\n\nOn the other hand,  \n\n\\[\n\\sum a_i Q(a_i) = \\sum a_i(\\lambda + 2\\mu a_i + 3\\nu a_i^2)\n               = \\lambda n + 2\\mu\\cdot2n + 3\\nu\\cdot3n\n               = n(\\lambda + 4\\mu + 9\\nu).\n\\]\n\nThus  \n\n\\[\n\\lambda + 4\\mu + 9\\nu = -\\frac{D}{n}. \\tag{11}\n\\]\n\nFinally, compute \\(\\sum (a_i-1)Q(a_i)\\) in two ways. Using (10) and (9),\n\n\\[\n\\sum (a_i-1)Q(a_i) = \\sum a_i Q(a_i) - \\sum Q(a_i) = -D - 0 = -D. \\tag{12}\n\\]\n\nExpanding directly and employing the given moments gives  \n\n\\[\n\\begin{aligned}\n\\sum (a_i-1)Q(a_i)\n&= \\lambda\\sum (a_i-1) + 2\\mu\\sum a_i(a_i-1) + 3\\nu\\sum a_i^2(a_i-1)\\\\\n&= \\lambda\\cdot0 + 2\\mu\\bigl(\\sum a_i^2-\\sum a_i\\bigr) + 3\\nu\\bigl(\\sum a_i^3-\\sum a_i^2\\bigr)\\\\\n&= 2\\mu\\,(2n-n) + 3\\nu\\,(3n-2n) = n(2\\mu+3\\nu). \\tag{13}\n\\end{aligned}\n\\]\n\nComparing (12) and (13) we obtain  \n\n\\[\n2\\mu + 3\\nu = -\\frac{D}{n}. \\tag{14}\n\\]\n\n---\n#### 7.  The form of \\(Q\\)  \n\nFrom (9) we have \\(\\lambda = -2\\mu - 6\\nu\\). Substituting (14) into this expression yields  \n\n\\[\n\\mu = -\\frac12\\Bigl(\\frac{D}{n}+3\\nu\\Bigr),\\qquad \n\\lambda = \\frac{D}{n} - 3\\nu.\n\\]\n\nConsequently  \n\n\\[\nQ(x) = \\Bigl(\\frac{D}{n}-3\\nu\\Bigr) + 2\\Bigl(-\\frac12\\Bigl(\\frac{D}{n}+3\\nu\\Bigr)\\Bigr)x + 3\\nu x^2\n     = 3\\nu x^2 - \\Bigl(\\frac{D}{n}+3\\nu\\Bigr)x + \\frac{D}{n}. \\tag{15}\n\\]\n\n*If \\(\\nu = 0\\)*, then \\(Q(x)=\\frac{D}{n}(1-x)\\); its only root is \\(x=1\\).\n\n*If \\(\\nu \\neq 0\\)*, \\(Q\\) is a quadratic. Its discriminant is  \n\n\\[\n\\Delta = \\Bigl(\\frac{D}{n}+3\\nu\\Bigr)^{2} - 12\\nu\\frac{D}{n}\n       = \\Bigl(\\frac{D}{n}-3\\nu\\Bigr)^{2}\\ge0,\n\\]\n\nso \\(Q\\) factorises as  \n\n\\[\nQ(x) = 3\\nu\\,(x-1)\\bigl(x - r\\bigr),\\qquad \nr = \\frac{D}{3n\\nu}. \\tag{16}\n\\]\n\n---\n#### 8.  Location of the second root  \n\nRecall \\(Q(m)>0,\\;Q(M)<0\\) and \\(m<1<M\\).\n\n* **Case \\(\\nu>0\\).**  From (16), \\(Q(m)=3\\nu\\,(m-1)(m-r)>0\\). Since \\(m-1<0\\), we must have \\(m-r<0\\Rightarrow r>m\\).  \n  Similarly \\(Q(M)=3\\nu\\,(M-1)(M-r)<0\\) and \\(M-1>0\\) give \\(M-r<0\\Rightarrow r>M\\). Hence \\(r>M\\).\n\n* **Case \\(\\nu<0\\).**  Now \\(3\\nu<0\\). \\(Q(m)>0\\) implies \\((m-1)(m-r)<0\\); with \\(m-1<0\\) this yields \\(m-r>0\\Rightarrow r<m\\).  \n  \\(Q(M)<0\\) gives \\((M-1)(M-r)>0\\); with \\(M-1>0\\) we obtain \\(M-r>0\\Rightarrow r<M\\). Thus \\(r<m\\).\n\nIn both cases \\(r\\) lies **outside** the open interval \\((m,M)\\). Consequently the only root of \\(Q\\) that can belong to \\((m,M)\\) is \\(x=1\\) (the linear case \\(\\nu=0\\) also gives the unique root \\(1\\)).\n\n---\n#### 9.  All interior points equal \\(1\\)  \n\nBecause the minimiser contains at least three distinct values, there exists an index with \\(m<a_i<M\\) (see (\u2217)). For such an index (8) holds, i.e. \\(Q(a_i)=0\\). Since \\(a_i\\in(m,M)\\), the discussion above forces \\(a_i=1\\).  \nThe same reasoning applies to every index whose value is strictly between \\(m\\) and \\(M\\); therefore  \n\n\\[\na_i \\in \\{M,\\;m,\\;1\\}\\quad\\text{for all } i.\n\\]\n\nLet  \n\n\\[\nr=\\#\\{i:a_i=M\\},\\qquad s=\\#\\{i:a_i=m\\},\\qquad t=\\#\\{i:a_i=1\\},\n\\]\n\nso that \\(r+s+t=n\\). Because we have shown that at least one interior point exists and it equals \\(1\\), we have \\(t\\ge1\\).\n\n---\n#### 10.  Algebraic relations for the three\u2011value configuration  \n\nWith \\(u=M-1,\\;v=1-m\\;(>0)\\) the moment conditions become  \n\n\\[\n\\begin{aligned}\nr u - s v &=0, \\tag{E1}\\\\\nr u^{2}+ s v^{2} &= n, \\tag{E2}\\\\\nr u^{3}- s v^{3} &= -n. \\tag{E3}\n\\end{aligned}\n\\]\n\nSet \\(K = r u = s v\\). From (E2), \\(K(u+v)=n\\), i.e. \\(K = n/D\\) where \\(D=u+v\\). Hence  \n\n\\[\nr = \\frac{K}{u}= \\frac{n}{u D},\\qquad s = \\frac{n}{v D}. \\tag{17}\n\\]\n\nSubstituting (17) into (E3) gives  \n\n\\[\nK(u^{2}-v^{2}) = -n \\;\\Longrightarrow\\; \\frac{n}{D}(u^{2}-v^{2}) = -n\n\\;\\Longrightarrow\\; u^{2}-v^{2} = -D.\n\\]\n\nSince \\(u^{2}-v^{2}=(u-v)(u+v)=(u-v)D\\), we obtain \\(u-v=-1\\), i.e.  \n\n\\[\nv = u+1,\\qquad D = 2u+1. \\tag{18}\n\\]\n\nThe number of entries different from \\(1\\) is \\(S = r+s\\). Using (17),\n\n\\[\nS = \\frac{n}{u D} + \\frac{n}{v D}\n  = \\frac{n}{D}\\Bigl(\\frac1u+\\frac1v\\Bigr)\n  = \\frac{n}{D}\\cdot\\frac{u+v}{uv}\n  = \\frac{n}{uv}. \\tag{19}\n\\]\n\nThus \\(uv = n/S\\). Now compute \\(D^{2}\\):\n\n\\[\nD^{2} = (2u+1)^{2} = 4u^{2}+4u+1 = 4u(u+1)+1 = 4uv+1 = 1 + \\frac{4n}{S}. \\tag{20}\n\\]\n\n---\n#### 11.  A lower bound involving \\(n\\)  \n\nBecause \\(t\\ge1\\) we have \\(S = n-t \\le n-1\\). Therefore (20) yields  \n\n\\[\nD^{2} \\ge 1 + \\frac{4n}{\\,n-1\\,}.\n\\]\n\nA simple algebraic manipulation shows  \n\n\\[\n1 + \\frac{4n}{n-1} = 5 + \\frac{4}{n-1}.\n\\]\n\nSet \\(\\delta = \\frac{4}{n-1}>0\\). Then \\(D \\ge \\sqrt{5+\\delta}\\) and  \n\n\\[\nD - \\sqrt5 \\ge \\sqrt{5+\\delta} - \\sqrt5 = \\frac{\\delta}{\\sqrt{5+\\delta} + \\sqrt5}. \\tag{21}\n\\]\n\n---\n#### 12.  Extracting the required asymptotic estimate  \n\nFor any \\(\\delta\\ge0\\) we have  \n\n\\[\n\\sqrt{5+\\delta} + \\sqrt5 \\le 2\\sqrt5 + \\delta,\n\\]\n\nbecause \\((2\\sqrt5+\\delta)-(\\sqrt{5+\\delta}+\\sqrt5)=\\sqrt5+\\delta-\\sqrt{5+\\delta}\\) is an increasing function of \\(\\delta\\) vanishing at \\(\\delta=0\\). Hence  \n\n\\[\nD - \\sqrt5 \\ge \\frac{\\delta}{2\\sqrt5 + \\delta}. \\tag{22}\n\\]\n\nSubstituting \\(\\delta = 4/(n-1)\\) gives  \n\n\\[\nD - \\sqrt5 \\ge \\frac{4/(n-1)}{2\\sqrt5 + 4/(n-1)}\n           = \\frac{4}{2\\sqrt5\\,(n-1) + 4}.\n\\]\n\nSince \\(2\\sqrt5\\,(n-1) + 4 < 2\\sqrt5\\,n\\) (because \\(2\\sqrt5 n - [2\\sqrt5\\,(n-1)+4] = 2\\sqrt5-4 >0\\)), we obtain  \n\n\\[\n\\frac{4}{2\\sqrt5\\,(n-1) + 4} \\;>\\; \\frac{4}{2\\sqrt5\\,n}\n   = \\frac{2}{\\sqrt5}\\,\\frac1n.\n\\]\n\nThus \\(D - \\sqrt5 > \\frac{2}{\\sqrt5}\\,\\frac1n\\), and consequently  \n\n\\[\nD - \\sqrt5 \\ge \\frac{2}{\\sqrt5}\\,\\frac1n. \\tag{23}\n\\]\n\nFor every integer \\(n\\ge 1\\) we have \\(\\frac1n \\ge n^{-3/2}\\) (because \\(n^{1/2}\\ge1\\)). Applying this to (23) yields  \n\n\\[\nD - \\sqrt5 \\ge \\frac{2}{\\sqrt5}\\,n^{-3/2}.\n\\]\n\nFinally,\n\n\\[\n\\boxed{\\;\\max_i a_i - \\min_i a_i \\ge \\sqrt5 + \\frac{2}{\\sqrt5}\\,n^{-3/2}\\; }.\n\\]\n\nThus we can take \\(C_2 = \\dfrac{2}{\\sqrt5}\\) (any smaller positive constant also works). This completes the proof of part\u202f(ii). \u220e", "average_automatic_rating": 0.7109375, "human_rating": 9}}
